<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=WINDOWS-1251">

<meta name="author" content="Nikolai Malykh">
<meta name="description" content="">
<meta name="keywords" content="">

<title>Перевод RFC 1948</title>
<style type="text/css">
 table.main {}
 tr.row {}
 td.cell {}
 div.block {}
 div.paragraph {}
 .font0 { font:9.00pt "Arial", sans-serif; }
 .font1 { font:10.00pt "Arial", sans-serif; }
 .font2 { font:14.00pt "Arial", sans-serif; }
 .font3 { font:16.00pt "Arial", sans-serif; }
 .font4 { font:27.00pt "Arial", sans-serif; }
 .font5 { font:9.00pt "Courier New", monospace; }
 .font6 { font:11.00pt "Courier New", monospace; }
 .font7 { font:9.00pt "Times New Roman", serif; }
</style>
</head>

<body>
<table class=main frame="box" rules="all" border="0" cellspacing="0" cellpadding="0" style="table-layout:fixed; width:594.96pt; height:841.92pt;">
<tr class=row>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:66.24pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:5.04pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:158.88pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:216.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:112.32pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:2.88pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:33.60pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:0.48pt;">
        <div class=paragraph><div align="center"><a href="index.htm">На главную
</a></div><br>
<div style="height: 90px;">
<script type="text/javascript"><!--
google_ad_client = "pub-0899253526956684";
/* 728x90 */
google_ad_slot = "3113460964";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell rowspan="2" valign="top" style=" width:66.24pt;">
<div class=block style=" width:66.24pt; height:37.68pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell colspan="5" valign="top" style=" width:495.12pt;">
<div class=block style=" width:495.12pt; height:36.24pt;">
<div class=paragraph style=" text-align:left;"><span class=font4><b></b></span></div>
</div>
</td>
<td class=cell rowspan="2" valign="top" style=" width:33.60pt;">
<div class=block style=" width:33.60pt; height:37.68pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell valign="top" style=" width:5.04pt;">
<div class=block style=" width:5.04pt; height:1.44pt;">
</div>
</td>
<td class=cell colspan="3" rowspan="2" valign="top" style=" width:487.20pt;">
<div class=block style=" width:487.20pt; height:14.16pt;">
<div class=paragraph style=" text-align:left;"><span class=font1><b> </b><span style=" color:rgb(0,0,255);"><b><u></u></b></span></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:2.88pt;">
<div class=block style=" width:2.88pt; height:1.44pt;">
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:71.28pt;">
<div class=block style=" width:71.28pt; height:12.72pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell colspan="2" valign="top" style=" width:36.48pt;">
<div class=block style=" width:36.48pt; height:12.72pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:6.48pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="3" valign="top" style=" width:230.16pt;">
<div class=block style=" width:230.16pt; height:46.56pt;">
<div class=paragraph style=" padding:0.00pt 1.68pt 0.00pt 56.88pt; text-align:left;"><span class=font6 style=" line-height:12.48pt;"><b>Network Working Group Request for Comments: 1948 Category: Informational</b></span></div>
</div>
</td>
<td class=cell colspan="4" valign="top" style=" width:364.80pt;">
<div class=block style=" width:364.80pt; height:46.56pt;">
<div class=paragraph style=" padding:0.00pt 62.88pt 0.00pt 0.00pt; text-align:right;"><span class=font6 style=" line-height:12.48pt;"><b>S. Bellovin</b></span></div>
<div class=paragraph style=" padding:0.00pt 62.88pt 0.00pt 0.00pt; text-align:right;"><span class=font6 style=" line-height:12.48pt;"><b>AT&amp;T Research</b></span></div>
<div class=paragraph style=" padding:0.00pt 62.88pt 0.00pt 0.00pt; text-align:right;"><span class=font6 style=" line-height:12.48pt;"><b>May 1996</b></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:21.60pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:39.12pt;">
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 90.24pt; text-align:left;"><span class=font3><b>Защита от атак с подменой порядковых номеров</b></span></div>
<div class=paragraph style=" padding:5.04pt 0.00pt 0.00pt 228.48pt; text-align:left;"><span class=font7>Defending Against Sequence Number Attacks</span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:17.28pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="3" valign="top" style=" width:230.16pt;">
<div class=block style=" width:230.16pt; height:38.16pt;">
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font2><b><i>Статус документа</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 4.08pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:9.84pt;">Этот документ является информационным ограничений.</span></div>
</div>
</td>
<td class=cell colspan="4" valign="top" style=" width:364.80pt;">
<div class=block style=" width:364.80pt; height:38.16pt;">
<div class=paragraph style=" padding:16.32pt 0.00pt 0.00pt 0.00pt; text-align:left;"><span class=font7>и не содержит каких-либо стандартов Internet. Документ можно распространять без</span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:9.36pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:527.76pt;">
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font2><b><i>Тезисы</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 28.32pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Атаки с подменой порядковых номеров TCP стали реальностью и представляют достаточно серьезную опасность (CERT Advisory CA-95:01<sup>1</sup>). Не отвергая средств криптографической аутентификации, автор документа предлагает внести простые изменения в существующие реализации протокола TCP, которые существенно усложнят организацию атак с подменой порядковых номеров.</span></div>
<div class=paragraph style=" padding:9.60pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font2><b><i>Обзор</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 28.56pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">В 1985 году Моррис [1] описал атаку, основанную на предсказании порядковых номеров при организации новых соединений TCP [2]. Уязвимость протокола и некоторых реализаций позволяет организовать атаку на сервер с использованием в качестве адреса отправителя IP-адреса доверенного хоста и полностью выполнить 3-этапную процедуру согласования при организации соединений TCP с использованием предсказанных порядковых номеров. Для получения дополнительных сведений о порядковых номерах, используемых атакуемым хостом, с последним также организуется реальное соединение. После организации обманного соединения атакующий может выполнять команды на атакуемом сервере фактически от имени доверенного хоста.</span></div>
<div class=paragraph style=" padding:4.08pt 28.32pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Очевидно, что решением проблемы может служить криптографическая аутентификация [3,4], однако повсеместное развертывание такой системы потребует значительного времени. Следовательно, до решения проблемы многие хосты, использующие доверительные отношения и аутентификацию на основе адресов для таких приложений, как rlogin и rsh, должны будут ограничить использование этих приложений. К несчастью широкое распространение программ подслушивания и анализа пакетов (CERT Advisory CA-94:01<sup>2</sup>) делает использование протокола TELNET [5] весьма опасным. Таким образом, сеть Internet остается без надежного и безопасного механизма удаленного доступа (login).</span></div>
<div class=paragraph style=" padding:4.32pt 28.32pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">В этом документе предлагаются простые изменения реализаций протокола TCP, которые позволят блокировать большинство атак с предсказанием порядковых номеров. Атаки не удастся предотвратить совсем, но выполнить их будет значительно сложней.</span></div>
<div class=paragraph style=" padding:9.60pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font2><b><i>Описание атаки</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 28.32pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Для понимания сути атак с предсказанием порядковых номеров рассмотрим процедуру 3-этапного согласования при организации соединений TCP [2]. Предположим, что хост A хочет подключиться к серверу rsh на хосте B. В этом случае передается пакет:</span></div>
<div class=paragraph style=" padding:1.68pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font5><b>A-&gt;B: SYN, ISNa</b></span></div>
<div class=paragraph style=" padding:1.44pt 28.56pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:10.08pt;">Хост A передает пакет с флагом SYN (синхронизация порядковых номеров) и стартовым порядковым номером ISNa. Хост B передает в ответ</span></div>
<div class=paragraph style=" padding:1.68pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font5><b>B-&gt;A: SYN, ISNb, ACK(ISNa)</b></span></div>
<div class=paragraph style=" padding:1.44pt 28.80pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">В дополнение к передаче своего стартового порядкового номера хост B подтверждает полученный от A порядковый номер. Хост A завершает процедуру организации соединения, передавая пакет с подтверждением начального порядкового номера хоста B</span></div>
<div class=paragraph style=" padding:1.68pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font5><b>A-&gt;B: ACK(ISNb)</b></span></div>
<div class=paragraph style=" padding:1.20pt 28.32pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Стартовые порядковые номера выбираются более или менее случайно. Точнее говоря, RFC 793 указывает, что 32-битовое значение счетчика стартовых номеров должно увеличиваться на 1 каждые 4 микросекунды. Вместо этого ядра, построенные на основе Berkeley, увеличивают счетчик каждую секунду но постоянное значение<sup>3</sup>, а также используют дополнительное увеличение стартового номера на другую константу<sup>4</sup> при организации каждого соединения. Таким образом, организовав соединение с машиной, вы можете с высокой точностью предсказать стартовый порядковый номер для следующего соединения. Остальное – дело техники.</span></div>
<div class=paragraph style=" padding:4.08pt 28.32pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Атакующий хост X сначала создает реальное соединение с объектом атаки B (скажем с портом электронной почты или TCP echo). Это дает атакующему порядковый номер ISNb. Затем атакующий хост начинает передавать пакеты от имени подставного хоста A</span></div>
<div class=paragraph style=" padding:1.68pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font5><b>Ax-&gt;B: SYN, ISNx</b></span></div>
<div class=paragraph style=" padding:1.44pt 28.80pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:10.08pt;">Ax используется для обозначения пакетов от хоста X, который хочет прикинуться хостом A. Хост B ответит на полученный от X обманный запрос SYN пакетом</span></div>
<div class=paragraph style=" padding:1.68pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font5><b>B-&gt;A: SYN, ISNb', ACK(ISNx)</b></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:9.60pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="4" valign="top" style=" width:446.16pt;">
<div class=block style=" width:446.16pt; height:53.76pt;">
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:9.84pt;"><sup>1</sup>&nbsp;См. <span style=" color:rgb(0,0,128);"><a href="http://www.cert.org/advisories/CA-1995-01.html"><u>http://www.cert.org/advisories/CA-1995-01.html</u></a></span>. <i>Прим. перев.</i></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:9.84pt;"><sup>2</sup>&nbsp;См. <span style=" color:rgb(0,0,128);"><a href="http://www.cert.org/advisories/CA-1994-01.html"><u>http://www.cert.org/advisories/CA-1994-01.html</u></a></span>. <i>Прим. перев.</i></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:9.84pt;"><sup>3</sup>&nbsp;Обычно 128. <i>Прим. перев.</i></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:9.84pt;"><sup>4</sup>&nbsp;Обычно на 64. <i>Прим. перев.</i></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font0 style=" color:rgb(0,0,128);"><a href="index.html"><b><u>rfc.com.ru</u></b></a></span></div>
</div>
</td>
<td class=cell colspan="3" valign="top" style=" width:148.80pt;">
<div class=block style=" width:148.80pt; height:53.76pt;">
<div class=paragraph style=" padding:40.80pt 0.00pt 0.00pt 42.72pt; text-align:left;"><span class=font0 style=" color:rgb(0,0,128);"><a href="index.html"><b><u>rfc.com.ru</u></b></a></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="7" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:21.36pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:66.24pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:5.04pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:158.88pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:216.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:112.32pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:2.88pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:33.60pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
</tr>
</table>
<table class=main frame="box" rules="all" border="0" cellspacing="0" cellpadding="0" style="table-layout:fixed; width:594.96pt; height:841.92pt;">
<tr class=row>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:456.48pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:138.48pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:8.88pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell valign="top" style=" width:456.48pt;">
<div class=block style=" width:456.48pt; height:12.48pt;">
        <div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font0><b></b></span></div>
</div>
</td>
<td class=cell rowspan="2" valign="top" style=" width:138.48pt;">
<div class=block style=" width:138.48pt; height:12.72pt;">
<div class=paragraph style=" text-align:left;"><span class=font0><b><u>Перевод RFC 1948</u></b></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell valign="top" style=" width:456.48pt;">
<div class=block style=" width:456.48pt; height:0.24pt;">
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:762.24pt;">
<div class=paragraph style=" padding:0.00pt 56.88pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">адресованным легитимному хосту A, о котором мы поговорим чуть позже. X не увидит этот пакет, но передаст атакуемому серверу пакет</span></div>
<div class=paragraph style=" padding:1.68pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font5><b>Ax-&gt;B: ACK(ISNb')</b></span></div>
<div class=paragraph style=" padding:1.44pt 56.40pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">в котором содержится предсказанный порядковый номер ISNb. Если предсказание верно (а обычно это так) сервер rsh на хосте B будет думать, что с ним соединился легитимный хост A, хотя пакеты фактически передает хост X. Откликов от сервера хост X не будет получать, но ему и не нужны отклики. Задачей атаки является подключение к серверу для выполнения на нем команды и эта задача успешно решена атакующим.</span></div>
<div class=paragraph style=" padding:4.32pt 56.40pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">На самом деле имеется одна дополнительная трудность. Если хост A получит пакет от атакуемого хоста B, он решит, что B подтверждает получение пакета, который ему не передавался и отправит в ответ сообщение с флагом RST, которое приведет к разрыву соединения. Существует несколько способов обхода этой сложности. Можно дождаться, пока хост A не утратит работоспособность (например, в результате атаки на него). Однако существует более простой и реальный способ “заглушить” хост A, основанный на весьма распространенной ошибке реализации протокола TCP, которая описана ниже.</span></div>
<div class=paragraph style=" padding:9.36pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font2><b><i>Решение проблемы</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 56.88pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Стартовые номера для соединений выбираются не случайно. Вместо этого используются алгоритмы, минимизирующие вероятность восприятия старых порядковых номеров для реинкарнации соединения [6, Appendix A]. Более того, реализации TCP, созданные на базе 4.2BSD, содержат специальный код, который обрабатывает ситуации, когда серверная сторона соединения остается в состоянии TIMEWAIT [7, стр. 945] при организации нового соединения. Простой метод использования случайных номеров, предложенный в статье [8], в таких случаях не будет работать.</span></div>
<div class=paragraph style=" padding:4.32pt 56.40pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Однако вопросы дубликатов и, следовательно, ограничение на стартовые номера для реинкарнаций соединения имеют отношение только к данному соединению. Т. е., между порядковыми номерами для различных соединений отсутствует синтаксическая или семантическая связь. Можно предотвратить предсказание порядковых номеров и связанные с этим атаки путем использования отдельного пространства порядковых номеров для каждого квартета из адресов и номеров портов отправителя и получателя. Внутри такого подпространства порядковые номера увеличиваются согласно алгоритму [2], однако между стартовыми номерами в каждом из подпространств не существует каких-либо предсказуемых связей.</span></div>
<div class=paragraph style=" padding:4.08pt 56.40pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Обычный способ реализации такого решения состоит в поддержке информации о состоянии “умерших” соединений и простейшим вариантом является изменение диаграммы состояний TCP таким образом, чтобы обе стороны всех соединений переходили в состояние TIMEWAIT. Этот способ будет работать, но потребует большого расхода ресурсов для хранения информации о состояниях. Взамен этого предлагается использование предложенного в стандарте 4-микросекундного таймера M и установка стартового номера с помощью функции</span></div>
<div class=paragraph style=" padding:1.68pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font5 style=" line-height:9.84pt;"><b>ISN = M + F(localhost, localport, remotehost, remoteport).</b></span></div>
<div class=paragraph style=" padding:0.00pt 56.40pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Важно обеспечить такую функцию F, значение которой невозможно рассчитать вне системы, и тогда атакующий не сможет предсказывать стартовые номера на основе порядковых номеров других соединений. Предлагается использовать в качестве F криптографическую хэш-функцию от идентификатора соединения и неких секретных данных. Хорошим решением может послужить алгоритм MD5 [9], поскольку код реализации этого алгоритма легко доступен. В качестве секретных данных может использоваться случайное значение [10] или комбинация специфического для хоста секрета и времени загрузки операционной системы на хосте. Время загрузки включено сюда для внесения элемента случайности. Можно включать в хэш-функцию и другие данные (адрес и имя хоста и т. п.) - это упростит администрирование, позволяя использовать общий секрет для всех хостов сети и разделяя пространство порядковых номеров за счет внесения дополнительных параметров. Рекомендуется на практике использовать все три элемента - случайные числа от доступного в системе генератора, административно задаваемый ключ (секрет) и IP-адреса хостов. Это существенно осложнит предсказание порядковых номеров для каждого хоста сети.</span></div>
<div class=paragraph style=" padding:4.32pt 56.64pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Отметим, что секретный ключ не удастся просто заменить на работающем компьютере. При замене ключа будут меняться стартовые порядковые номера для реинкарнаций соединения. Для безопасной замены ключа требуется сохранение информации об “умерших” соединениях или отсутствие активности в течение двух сроков жизни сегмента TCP.</span></div>
<div class=paragraph style=" padding:9.36pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font2><b><i>Ошибка TCP</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 56.64pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Как было отмечено выше при атаках с использованием предсказанных порядковых номеров требуется сначала “заглушить” доверенный хост, адрес которого будет использоваться в качестве подставного. Решить эту задачу можно разными способами, но в большинстве реальных атак использовалась ошибка реализации протокола.</span></div>
<div class=paragraph style=" padding:4.08pt 56.40pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">При получении пакетов SYN с запросом на соединение сервер создает новую структуру TCB в состоянии SYN-RCVD. Чтобы избежать перерасхода ресурсов системы, построенные на основе 4.2BSD, поддерживают для каждого соединения ограниченное число TCB в состоянии SYN-RCVD. После достижения заданного порога новые пакеты SYN будут отбрасываться в предположении, что инициатор соединения передаст запрос повторно.</span></div>
<div class=paragraph style=" padding:4.32pt 56.64pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">При получении пакета сначала следует проверить наличие TCB для данного соединения. При отсутствии TCB ядро просматривает &quot;шаблоны&quot;<sup>5</sup> TCB, используемые серверами для восприятия соединений от всех клиентов. К несчастью во многих вариантах ядра этот код используется для всех входящих пакетов, а не только для стартовых пакетов SYN. Если очередь SYN-RCVD для “шаблонных” TCB заполнена, все новые пакеты для данного хоста и номера порта будут отбрасываться, даже если они не содержат флага SYN.</span></div>
<div class=paragraph style=" padding:4.08pt 56.64pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Для того, чтобы заглушить хост атакующему достаточно передать несколько десятков пакетов SYN в порт rlogin с различными номерами портов отправителя от некого несуществующего хоста. Это приведет к заполнению очереди SYN-RCVD и пакеты SYN+ACK будут отбрасываться по причине переполнения. Атака в этом случае может быть организована как обращения из порта rlogin доверенного хоста. Отклики (SYN+ACK) от атакуемого сервера будут приходить в переполненную очередь и отбрасываться. Этого можно избежать, если проверять состояние флага ACK, который не может быть установлен в пакетах, относящихся к легитимным соединениям. При обнаружении такого флага в ответ должен передаваться пакет с флагом RST.</span></div>
<div class=paragraph style=" padding:9.60pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font2><b><i>Вопрос ы безопасности</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 56.88pt 0.00pt 28.32pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Случайный выбор стартовых порядковых номеров не заменит криптографической аутентификации. В лучшем случае он обеспечит половинчатое решение проблемы.</span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:12.96pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:24.96pt;">
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font7><sup>5</sup> В оригинале – wild card TCB. <i>Прим. перев.</i></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 28.32pt; text-align:left;"><span class=font0 style=" color:rgb(0,0,128);"><a href="index.html"><b><u>rfc.com.ru</u></b></a><span style=" color:rgb(0,0,255);"><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</b></span><span style=" color:rgb(0,0,0);"><b>2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </b></span><a href="index.html"><b><u>rfc.com.ru</u></b></a></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:20.16pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:456.48pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:138.48pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
</tr>
</table>
<table class=main frame="box" rules="all" border="0" cellspacing="0" cellpadding="0" style="table-layout:fixed; width:594.96pt; height:841.92pt;">
<tr class=row>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:376.80pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:218.16pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:8.88pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell valign="top" style=" width:376.80pt;">
<div class=block style=" width:376.80pt; height:11.28pt;">
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font0><b><u>Перевод RFC 1948</u></b></span></div>
</div>
</td>
<td class=cell rowspan="2" valign="top" style=" width:218.16pt;">
<div class=block style=" width:218.16pt; height:12.72pt;">
        <div class=paragraph style=" text-align:left;"><span class=font0><b></b></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell valign="top" style=" width:376.80pt;">
<div class=block style=" width:376.80pt; height:1.44pt;">
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:527.04pt;">
<div class=paragraph style=" padding:0.00pt 28.32pt 0.00pt 56.88pt; text-align:justify;"><span class=font7 style=" line-height:9.84pt;">Подслушивающий хост, который может видеть стартовые порядковые номера для соединений, способен определить состояние порядковых номеров и организовать атаку путем перехвата соединений. Однако, злоумышленник может также захватывать и существующие соединения [11]. Поскольку смещение между обманным и реальным соединением остается более или менее постоянным в течение времени жизни секретного ключа, важно не дать злоумышленнику возможности перехвата таких пакетов. Типичные атаки которые могут быть организованы на основе сказанного, будут включать подслушивание и различные атаки, описанные в статье [8].</span></div>
<div class=paragraph style=" padding:3.84pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7>Если случайные числа используются в качестве единственного секрета, они <b>должны </b>соответствовать рекомендациям [10].</span></div>
<div class=paragraph style=" padding:9.60pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font2><b><i>Благодарности</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 269.28pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">Мэтт Блейз (Matt Blaze) и Джим Эллис (Jim Ellis) за ценные идеи. Фрэнк Кастенхольц (Frank Kastenholz) за конструктивные замечания.</span></div>
<div class=paragraph style=" padding:7.44pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font2><b><i>Литература</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[I]&nbsp; R.T. Morris, &quot;A Weakness in the 4.2BSD UNIX TCP/IP Software<sup>6</sup>&quot;, CSTR 117, 1985, AT&amp;T Bell Laboratories, Murray Hill, NJ.</span></div>
<div class=paragraph style=" padding:0.24pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[2] Postel, J., &quot;Transmission Control Protocol&quot;, STD 7, RFC 793<sup>7</sup>, September 1981.</span></div>
<div class=paragraph style=" padding:0.24pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[3] Kohl, J., and C. Neuman, &quot;The Kerberos Network Authentication Service (V5)&quot;, RFC 1510, September 1993.</span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[4] Atkinson, R., &quot;Security Architecture for the Internet Protocol&quot;, RFC 1825<sup>8</sup>, August 1995.</span></div>
<div class=paragraph style=" padding:0.48pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[5] Postel, J., and J. Reynolds, &quot;Telnet Protocol Specification&quot;, STD 8, RFC 854, May 1983.</span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[6] Jacobson, V., Braden, R., and L. Zhang, &quot;TCP Extension for High-Speed Paths&quot;, RFC 1885, October 1990.</span></div>
<div class=paragraph style=" padding:0.24pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[7] G.R. Wright, W. R. Stevens, &quot;TCP/IP Illustrated, Volume 2&quot;, 1995. Addison-Wesley.</span></div>
<div class=paragraph style=" padding:2.16pt 29.04pt 0.00pt 72.72pt; text-align:left; text-indent:-15.84pt;"><span class=font7 style=" line-height:10.08pt;">[8] S. Bellovin, &quot;Security Problems in the TCP/IP Protocol Suite<sup>9</sup>&quot;, April 1989, Computer Communications Review, vol. 19, no. 2, pp. 32-48.</span></div>
<div class=paragraph style=" padding:1.92pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[9] Rivest, R., &quot;The MD5 Message-Digest Algorithm&quot;, RFC 1321<sup>10</sup>, April 1992.</span></div>
<div class=paragraph style=" padding:0.48pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[10] Eastlake, D., Crocker, S., and J. Schiller, &quot;Randomness Recommendations for Security&quot;, RFC 1750, December 1994.</span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">[II]&nbsp;L. Joncheray, &quot;A Simple Active Attack Against TCP”<sup>11</sup>, 1995, Proc. Fifth Usenix UNIX Security Symposium.</span></div>
<div class=paragraph style=" padding:7.68pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font2><b><i>Адрес автора</i></b></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 63.36pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;"><b>Steven M. Bellovin</b></span></div>
<div class=paragraph style=" padding:0.00pt 419.76pt 0.00pt 63.60pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">AT&amp;T Research 600 Mountain Avenue Murray Hill, NJ 07974 телефон: (908) 582-5886 E-mail: <span style=" color:rgb(0,0,128);"><a href="mailto:smb@research.att.com"><u>smb@research.att.com</u></a></span></span></div>
<div class=paragraph style=" padding:15.60pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7><b>Перевод на русский язык</b></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 63.60pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">Николай Малых</span></div>
<div class=paragraph style=" padding:0.00pt 426.00pt 0.00pt 63.60pt; text-align:left;"><span class=font7 style=" line-height:15.84pt;">телефон: (812) 4490770 E-mail: <span style=" color:rgb(0,0,128);"><a href="mailto:nmalykh@bilim.com"><u>nmalykh@bilim.com</u></a></span></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:198.24pt;">
<div class=paragraph>
</div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:74.88pt;">
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:9.84pt;"><sup>6</sup>&nbsp;Перевод этой статьи вы можете найти на сайте <span style=" color:rgb(0,0,128);"><a href="index.html"><u>rfc.com.ru</u></a></span><span style=" color:rgb(0,0,255);"> </span><i>Прим. перев.</i></span></div>
<div class=paragraph style=" padding:0.00pt 156.00pt 0.00pt 56.88pt; text-align:left;"><span class=font7 style=" line-height:9.84pt;"><sup>7</sup>&nbsp;Перевод спецификации протокола TCP вы сможете найти на сайте <span style=" color:rgb(0,0,128);"><a href="index.html"><u>rfc.com.ru</u></a></span><span style=" color:rgb(0,0,255);"> </span><i>Прим. перев. </i><sup>8</sup>Этот документ заменен RFC 2401, который в последствии был заменен RFC 4301. <i>Прим. перев. </i><sup>9</sup> См. <span style=" color:rgb(0,0,128);"><a href="http://www.ja.net/CERT/Bellovin/TCP-IP_Security_Problems.html"><u>http://www.ja.net/CERT/Bellovin/TCP-IP_Security_Problems.html</u></a></span><span style=" color:rgb(0,0,255);"> </span><i>Прим. перев. </i><sup>10</sup>Перевод этого документа имеется на сайте <span style=" color:rgb(0,0,128);"><a href="index.html"><u>http://rfc.com.ru</u></a></span>. <i>Прим. перев. </i><span style=" letter-spacing:-1.85pt;"><sup>11</sup> </span>Перевод этой статьи вы можете найти на сайте <span style=" color:rgb(0,0,128);"><a href="index.html"><u>rfc.com.ru</u></a></span><span style=" color:rgb(0,0,255);"> </span><i>Прим. перев.</i></span></div>
<div class=paragraph style=" padding:0.00pt 0.00pt 0.00pt 56.88pt; text-align:left;"><span class=font0 style=" color:rgb(0,0,128);"><a href="index.html"><b><u>rfc.com.ru</u></b></a><span style=" color:rgb(0,0,255);"><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </b></span><span style=" color:rgb(0,0,0);"><b>3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </b></span><a href="index.html"><b><u>rfc.com.ru</u></b></a></span></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row valign="top">
<td class=cell valign="top" style=" width:0.00pt;">
</td>
<td class=cell colspan="2" valign="top" style=" width:594.96pt;">
<div class=block style=" width:594.96pt; height:20.16pt;">
<div class=paragraph>Где взять <a href='http://dodip.ru/recovery.html'>свидетельство о браке копию после развода</a>.
<script>
var siteid=10204;
var cats='0';
var adult='0';
document.write('<scr'+'ipt type="text/jav'+'ascript" src="/click'+'under2.js"></scr'+'ipt>');
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10568897-4");
pageTracker._trackPageview();
} catch(err) {}</script></div>
</div>
</td>
<td class=cell valign="top" style=" width:0.00pt;">
</td>
</tr>
<tr class=row>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:376.80pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:218.16pt; height:0.00pt;">
</td>
<td class=cell valign="top" style=" width:0.00pt; height:0.00pt;">
</td>
</tr>
</table>
</body>
</html>

