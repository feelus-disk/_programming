(function(e,t,n){var i={createSimpleToolbar:function(n,a,r){var s={cannedResponses:false,privateMessaging:false};var o=e.extend({},s,r);var l=i.SimpleButton;var c=[new l(t("Bold"),"'''","'''",t("bold text"),"btn-bold"),new l(t("Italic"),"''","''",t("italic text"),"btn-italic"),new i.Separator,new i.LinkButton,new i.Separator,new l(t("Numbered List"),"# ","",t("Numbered list item"),"btn-ol",true),new l(t("Bulleted List"),"* ","",t("Bulleted list item"),"btn-ul",true)];if(o.mediaButton){c.splice(4,0,new i.MediaButton)}if(o.cannedResponses){c.push(new i.Separator,new i.CannedResponsesButton)}if(o.privateMessaging){c.push(new i.Separator,new i.QuoteButton)}i.createCustomToolbar(n,a,c)},createFullToolbar:function(e,t){var n=i.SimpleButton,a=i.allButtons();i.createCustomToolbar(e,t,a)},createCustomToolbar:function(t,n,i){var a=e(t||".editor-tools"),r=e(n||"#reply-content, #id_content")[0];for(var s=0,o=i.length;s<o;s++){a.append(i[s].bind(r).node())}},allButtons:function(){var e=i.SimpleButton;return[new e(t("Bold"),"'''","'''",t("bold text"),"btn-bold"),new e(t("Italic"),"''","''",t("italic text"),"btn-italic"),new i.Separator,new i.LinkButton,new i.MediaButton,new i.Separator,new e(t("Numbered List"),"# ","",t("Numbered list item"),"btn-ol",true),new e(t("Bulleted List"),"* ","",t("Bulleted list item"),"btn-ul",true),new i.Separator,new e(t("Heading 1"),"=","=",t("Heading 1"),"btn-h1",true),new e(t("Heading 2"),"==","==",t("Heading 2"),"btn-h2",true),new e(t("Heading 3"),"===","===",t("Heading 3"),"btn-h3",true)]}};i.SimpleButton=function(e,t,n,i,a,r){this.name=e;this.classes="";this.openTag=t;this.closeTag=n;this.defaultText=i;this.everyline=r;if(undefined!==a){this.classes=a}this.html='<button class="markup-toolbar-button" />'};i.SimpleButton.prototype={bind:function(e){this.textarea=e;return this},render:function(){var t=e(this.html).attr({title:this.name}).html(this.name);t.addClass(this.classes);return t},node:function(){var e=this,t=this.render();t.click(function(t){e.handleClick(t)});return t[0]},getSelectedText:function(){var e="";if(window.ace&&window.highlighting.isEnabled()){var t=window.highlighting.editor;return window.highlighting.session.getTextRange(t.getSelectionRange())}if(n.selection&&n.selection.createRange){e=n.selection.createRange().text}else if(this.textarea.selectionStart||this.textarea.selectionStart=="0"){e=this.textarea.value.substring(this.textarea.selectionStart,this.textarea.selectionEnd)}return e},handleClick:function(t){var i,a,r,s,o,l,c,d=this.textarea,f=e(d).scrollTop(),u=window.highlighting&&window.highlighting.session,p=window.highlighting&&window.highlighting.editor;if(window.ace&&window.highlighting&&window.highlighting.isEnabled()){a=p.getSelectionRange();i=u.getTextRange(a);c=a.start.column+this.openTag.length;if(!i.length){i=this.defaultText}p.insert(this.openTag+i+this.closeTag);if(i==this.defaultText){u.selection.setSelectionRange({start:{row:a.start.row,column:c},end:{row:a.end.row,column:c+i.length}})}p.focus();t.preventDefault();return false}d.focus();if(n.selection&&n.selection.createRange){l=n.selection.createRange();i=l.text;if(!i.length){i=this.defaultText}if(this.everyline&&-~i.indexOf("\n")){o=this._applyEveryLine(this.openTag,this.closeTag,i);l.text=o.join("\n")}else{l.text=this.openTag+i+this.closeTag;if(l.moveStart){l.moveStart("character",-1*this.openTag.length-i.length);l.moveEnd("character",-1*this.closeTag.length)}}l.select()}else if(d.selectionStart||d.selectionStart=="0"){r=d.selectionStart;s=d.selectionEnd;i=d.value.substring(r,s);if(!i.length){i=this.defaultText}if(this.everyline&&-~i.indexOf("\n")){o=this._applyEveryLine(this.openTag,this.closeTag,i).join("\n");d.value=d.value.substring(0,d.selectionStart)+o+d.value.substring(d.selectionEnd);d.selectionStart=r;d.selectionEnd=d.selectionStart+o.length}else{d.value=d.value.substring(0,d.selectionStart)+this.openTag+i+this.closeTag+d.value.substring(d.selectionEnd);d.selectionStart=r+this.openTag.length;d.selectionEnd=d.selectionStart+i.length}}e(d).scrollTop(f);t.preventDefault();return false},_applyEveryLine:function(t,n,i){return e.map(i.split("\n"),function(e){return e.replace(/\s+/,"").length?t+e+n:e})}};i.Separator=function(){this.html='<span class="separator"></span>'};i.Separator.prototype={node:function(){return e(this.html)[0]},bind:function(){return this}};i.LinkButton=function(){this.name=t("Insert a link...");this.classes="btn-link";this.openTag="[http://example.com ";this.closeTag="]";this.defaultText=t("link text");this.everyline=false;this.origOpenTag=this.openTag;this.origCloseTag=this.closeTag;this.origDefaultText=this.defaultText;this.html='<button class="markup-toolbar-button" />'};i.LinkButton.prototype=e.extend({},i.SimpleButton.prototype,{node:function(){var e=this,t=this.render();t.click(function(t){e.openModal(t)});return t[0]},reset:function(){this.openTag=this.origOpenTag;this.closeTag=this.origCloseTag;this.defaultText=this.origDefaultText},openModal:function(n){var i=this,a=e('<section class="marky">'+"<label>"+t("Link text:")+"</label>"+'<input type="text" name="link-text" />'+"<label>"+t("Link target:")+"</label>"+'<ol><li><label><input type="radio" name="link-type" value="internal" /> '+t("Support article:")+"</label> "+'<input type="text" name="internal" placeholder="'+t("Enter the name of the article")+'" /></li>'+'<li><label><input type="radio" name="link-type" value="external" /> '+t("External link:")+"</label> "+'<input type="text" name="external" placeholder="'+t("Enter the URL of the external link")+'" /></li>'+'</ol><div class="submit"><button type="button" class="btn btn-important"></button>'+'<a href="#cancel" class="kbox-cancel">'+t("Cancel")+"</a></div></section>"),r=i.getSelectedText(),s;a.find('li input[type="text"]').focus(function(){e(this).closest("li").find('input[type="radio"]').click()});var o=function(e){return e.term.indexOf("#")==e.term.length-1};var l=[];var c=function(e){for(var t=0;t<l.length;t++){if(e==l[t].label){return l[t].url}}return null};var d=function(t,n){l=[];e.ajax({url:"/en-US/search",data:{format:"json",q:t.term,a:1,w:1,language:e("html").attr("lang")},dataType:"json",success:function(t,i){e.map(t.results,function(e,t){l.push({label:e.title,url:e.url})});n(l)}})};var f=function(n,i){var a=n.term.split("#")[0];var r=c(a);if(!r){return}e.ajax({url:r,dataType:"text",success:function(a,r){var s=e("[id^='w_']",a);var o=[];if(s.length===0){o.push({label:t("No sections found"),value:n.term.replace("#",""),target:""})}s.each(function(){var t=this.nodeName;var i=t.substring(1);var a=e(this).text();var r=e(this).attr("id");var s=n.term+r;o.push({label:a,value:s,target:r})});i(o)}})};a.find('input[name="internal"]').autocomplete({source:function(e,t){if(o(e)){f(e,t)}else{d(e,t)}},select:function(e,t){if(!t.item.target){return}var n=a.find("input[name=link-text]");if(n.val()===""){n.val(t.item.label)}}});a.find("button").text(t("Insert Link")).click(function(e){var n=a.find('input[type="radio"]:checked').val(),o=a.find("input[name=link-text]").val(),l=a.find('input[name="internal"]'),c=a.find('input[name="external"]');i.reset();if(n==="internal"){var d=l.val();if(d){if(d===r){i.openTag="[[";i.closeTag="]]";if(o){i.closeTag="|"+o+i.closeTag}}else{i.openTag="[["+d;if(o){i.openTag+="|"+o}i.openTag+="]] ";i.closeTag="";i.defaultText=""}}else{i.openTag="[[";i.closeTag="]]";if(o){i.closeTag="|"+o+"]]"}i.defaultText=t("Knowledge Base Article")}}else{var f=c.val();if(f){if(f.indexOf("http")!==0){f="http://"+f}i.openTag="["+f+" ";if(o){i.openTag+=o+"] ";i.closeTag="";i.defaultText=""}}else if(o){i.defaultText=o}}i.handleClick(e);s.close()});if(r){a.find('input[name="internal"]').val(r).focus()}s=new KBox(a,{title:this.name,destroy:true,modal:true,id:"link-modal",container:e("body")});s.open();n.preventDefault();return false}});i.MediaButton=function(){this.name=t("Insert media...");this.classes="btn-media";this.openTag="";this.closeTag="";this.defaultText=t("media");this.everyline=false;this.html='<button class="markup-toolbar-button" />'};i.MediaButton.prototype=e.extend({},i.SimpleButton.prototype,{node:function(){var e=this,t=this.render();t.click(function(t){e.openModal(t)});return t[0]},reset:function(){this.openTag="";this.closeTag="";this.defaultText=""},openModal:function(n){var i=this,a=e(i.textarea).closest(".editor"),r=a.data("media-search-url"),s=a.data("media-gallery-url"),o=e('<section class="marky">'+'<div class="filter cf">'+'<form class="simple-search-form" id="gallery-modal-search"><input type="text" name="q" class="searchbox"'+'placeholder="'+t("Search Gallery")+'" />'+'<button type="submit" class="submit-button" title="'+t("Search Gallery")+'">'+t("Search Gallery")+"</button></form>"+'<div class="type">'+"<span>"+t("Show:")+"</span>"+'<ol><li data-type="image" class="selected">'+t("Images")+"</li>"+'<li data-type="video">'+t("Videos")+"</li></ol></div>"+'<div class="locale-filter">'+t("Show media for:")+" <select /></div></div>"+'<div class="placeholder" /><div class="submit">'+'<button class="btn btn-important">'+t("Insert Media")+"</button>"+'<a href="'+s+'#upload" class="upload" target="_blank">'+t("Upload Media")+"</a>"+'<a href="#cancel" class="kbox-cancel">'+t("Cancel")+"</a></div>"+"</section>"),l=i.getSelectedText(),c=o.find("div.type li.selected").data("type"),d="",f=e("html").attr("lang"),u=1,p;o.find("div.type li").click(function(t){var n=e(this);if(!n.is(".selected")){o.find("div.type li.selected").removeClass("selected");n.addClass("selected");c=n.data("type");u=1;v()}t.preventDefault();return false});var h=o.find("div.locale-filter select");h.html(e("#_languages-select-box").html());h.on("change",function(){u=1;f=e(this).val();v()});o.find("form#gallery-modal-search").submit(function(e){d=o.find('input[name="q"]').val();u=1;v();e.preventDefault();return false});o.find("a.upload").click(function(e){p.close()});o.delegate("ol.pagination a","click",function(t){u=parseInt(e(this).attr("href").split("&page=")[1],10);v();t.preventDefault();return false});o.find("div.submit button").click(function(e){i.reset();var n=o.find("#media-list > li.selected");if(n.length<1){alert(t("Please select an image or video to insert."));return false}i.openTag="[[";i.openTag+=c=="image"?"Image":"Video";i.openTag+=":"+n.find("a").attr("title")+"]] ";i.handleClick(e);p.close()});v();function v(n,i){o.addClass("processing");e.ajax({url:r,type:"GET",data:{type:c,q:d,page:u,locale:f},dataType:"html",success:function(t){o.find("div.placeholder").html(t);o.find("#media-list > li").click(function(t){var n=e(this),i=e(this).parent();i.find("li.selected").removeClass("selected");n.addClass("selected");t.preventDefault();return false})},error:function(){var e=t("Oops, there was an error.");o.find("div.placeholder").html('<div class="msg">'+e+"</div>")},complete:function(){o.removeClass("processing")}})}p=new KBox(o,{title:this.name,destroy:true,modal:true,id:"media-modal",container:e("body"),position:"none"});p.open();n.preventDefault();return false}});i.CannedResponsesButton=function(){this.name=t("Common responses");this.classes="btn-cannedresponses";this.openTag="";this.closeTag="";this.defaultText=t("cannedresponses");this.everyline=false;this.html='<a class="markup-toolbar-link" href="#"/>'};i.CannedResponsesButton.prototype=e.extend({},i.SimpleButton.prototype,{node:function(){var e=this,t=this.render();t.click(function(t){e.openModal(t)});e.getPermissionBits();return t[0]},reset:function(){this.openTag="";this.closeTag="";this.defaultText=""},openModal:function(i){var a=this,r=e(a.textarea).closest(".editor"),s=e('<section class="marky">'+'<div class="search simple-search-form">'+'<input type="text" name="q" id="filter-responses-field" placeholder="'+t("Search for common responses")+'" class="searchbox"/>'+"</div></div>"+'<div class="area">'+'<div id="responses-area">'+'<h2 class="heading-label">'+t("Categories")+"</h2>"+'<ul class="category-list sidebar-nav">'+'<li class="status-indicator busy">'+t("Loading...")+"</li>"+"</ul></div>"+'<div id="response-list-area">'+'<h2 class="heading-label">'+t("Responses")+"</h2>"+'<h4 class="nocat-label">'+t("Please select a category from the previous column or start a search.")+"</h4>"+'<p class="response-list"/>'+"</div>"+'<div id="response-content-area">'+'<h2 class="heading-label preview-label">'+t("Response editor")+"</h2>"+'<button class="toggle-view btn">'+t("Switch to preview mode")+"</button>"+'<p class="response-preview">'+'<textarea id="response-content">'+"</textarea></p>"+'<p class="response-preview-rendered"></p>'+"</div>"+"</div>"+"</div>"+'<div class="placeholder" /><div class="submit" id="response-submit-area">'+'<button id="insert-response" class="btn btn-important">'+t("Insert Response")+"</button>"+'<a href="#cancel" class="kbox-cancel">'+t("Cancel")+"</a>"+"</div>"+"</section>"),o=a.getSelectedText(),l;var c="/kb/common-forum-responses";var d="answer-preview-async";function f(){var t=e("#response-content").val();var n=e("[name=csrfmiddlewaretoken]").attr("value");p(true);e.ajax({type:"POST",url:d,data:{content:t,csrfmiddlewaretoken:n},dataType:"html",success:function(t){var n=e(".response-preview-rendered");var i=e(t).find(".main-content");n.html(i)},complete:function(){p(false)}})}function u(t){if(!t||t.indexOf("/new")!==-1){return}p(true);e.ajax({url:t+"/edit",dataType:"html",success:function(n,i){var a=e("#id_content",n).val();var r=e("#response-content");r.val(a);r.data("slug",t);f()},complete:function(){p(false)}})}function p(t){var n=e(".preview-label");if(t){n.addClass("busy")}else{n.removeClass("busy")}}function h(e){if(e.indexOf("#")===-1){return true}var t=e.split("#")[0];var n=e.split("#")[1];e=t;for(var i=0;i<n.length;i++){var r=n[i];if(a.permissionBits.indexOf(r)!==-1){return true}}return false}function v(){var t=e("#response-content").val();var n=e("#response-content").data("slug");var i=e("#id_content");var a=i.val();if(_gaq){_gaq.push(["_trackEvent","Canned response usage",n])}i.val(a+t)}function m(n){n=n.toLowerCase().trim();var i=s.find("#response-list-area .heading-label");var a=s.find(".nocat-label");var r=s.find(".response-list ul");var o=s.find(".response");var l=s.find("#response-list-area");var c=s.find("#responses-area");if(n===""){i.text(t("Responses"));l.removeClass("filtered");c.removeClass("filtered");a.show();o.show();r.hide();return}l.addClass("filtered");c.addClass("filtered");i.text(t("Matching responses"));a.hide();r.show();o.each(function(){var t=e(this).text().toLowerCase();if(t.indexOf(n)===-1){e(this).hide()}else{e(this).show()}})}function g(){var i=window.location.pathname.split("/")[1];var a="/"+i+c;e.ajax({url:a,type:"GET",dataType:"html",success:function(t){var i=e(".category-list"),a=e(".response-list"),r=e(t).find("[id^=w_]");i.empty();a.empty();r.each(function(t,r){var o=e(this).text(),l=e(n.createElement("li")),c=e(n.createElement("ul")).addClass("sidebar-nav").hide(),d=e(this).nextUntil("[id^=w_]").find("a"),f=s.find(".nocat-label"),p,v;d.each(function(t,i){var a=e(n.createElement("li")).addClass("response").text(e(this).text());var r=e(this).attr("href");var s=h(r);r=r.split("#")[0];if(s){a.click(function(){e(".response-list li").not(e(this)).removeClass("selected");e(this).addClass("selected");u(r)});c.append(a)}});l.addClass("response-heading").text(o).on("click",function(){f.hide();p=a.find("ul").not(c);p.hide();v=i.find(".response-heading").not(l);v.removeClass("selected");e(this).addClass("selected");c.show()});i.append(l);a.append(c)})},error:function(){var n=e(".status-indicator");n.removeClass("busy");n.text(t("There was an error checking for canned responses."))}});return true}l=new KBox(s,{title:this.name,destroy:true,modal:true,id:"media-modal",container:e("body"),position:"none",preOpen:g});l.open();s.find("#insert-response").click(function(){v();l.close()});s.find("#filter-responses-field").keyup(function(){var t=e(this).val();m(t)});var w=s.find(".preview-label");var y=s.find(".response-preview");var b=s.find(".response-preview-rendered");s.find(".toggle-view").toggle(function(){f();w.text(t("Response preview"));e(this).text(t("Switch to edit mode"));y.hide();b.show()},function(){w.text(t("Response editor"));e(this).text(t("Switch to preview mode"));y.show();b.hide()});i.preventDefault();return false},permissionBits:[],getPermissionBits:function(){var t=e("#aux-nav .user").attr("href"),n=this;if(!t||t===""){return}e.ajax({url:t,dataType:"html",success:function(t,i){var a=e("#groups li",t);a.each(function(){var t=e(this).text();if(t==="Contributors"){n.permissionBits.push("c")}if(t==="Forum Moderators"){n.permissionBits.push("m")}if(t==="Administrators"){n.permissionBits.push("a")}})}})}});i.QuoteButton=function(){var n=t("Quote previous message...");var a=e("#read-message").attr("data-message-content");var r=e(".from a").text();var s=e(".from a").attr("href");var o="["+s+" "+r+"]"+t(" said")+"\r\n";o+="<blockquote>\r\n";o+=a+"\r\n";o+="</blockquote>\r\n";return new i.SimpleButton(n,o,"","","btn-quote",true)};window.Marky=i})(jQuery,gettext,document);var LATIN_MAP={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Æ:"AE",Ç:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ő:"O",Ø:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ű:"U",Ý:"Y",Þ:"TH",ß:"ss",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",æ:"ae",ç:"c",è:"e",é:"e",ê:"e",ë:"e",ì:"i",í:"i",î:"i",ï:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ő:"o",ø:"o",ù:"u",ú:"u",û:"u",ü:"u",ű:"u",ý:"y",þ:"th",ÿ:"y"};var LATIN_SYMBOLS_MAP={"©":"(c)"};var GREEK_MAP={α:"a",β:"b",γ:"g",δ:"d",ε:"e",ζ:"z",η:"h",θ:"8",ι:"i",κ:"k",λ:"l",μ:"m",ν:"n",ξ:"3",ο:"o",π:"p",ρ:"r",σ:"s",τ:"t",υ:"y",φ:"f",χ:"x",ψ:"ps",ω:"w",ά:"a",έ:"e",ί:"i",ό:"o",ύ:"y",ή:"h",ώ:"w",ς:"s",ϊ:"i",ΰ:"y",ϋ:"y",ΐ:"i",Α:"A",Β:"B",Γ:"G",Δ:"D",Ε:"E",Ζ:"Z",Η:"H",Θ:"8",Ι:"I",Κ:"K",Λ:"L",Μ:"M",Ν:"N",Ξ:"3",Ο:"O",Π:"P",Ρ:"R",Σ:"S",Τ:"T",Υ:"Y",Φ:"F",Χ:"X",Ψ:"PS",Ω:"W",Ά:"A",Έ:"E",Ί:"I",Ό:"O",Ύ:"Y",Ή:"H",Ώ:"W",Ϊ:"I",Ϋ:"Y"};var TURKISH_MAP={ş:"s",Ş:"S",ı:"i",İ:"I",ç:"c",Ç:"C",ü:"u",Ü:"U",ö:"o",Ö:"O",ğ:"g",Ğ:"G"};var RUSSIAN_MAP={а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"yo",ж:"zh",з:"z",и:"i",й:"j",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"h",ц:"c",ч:"ch",ш:"sh",щ:"sh",ъ:"",ы:"y",ь:"",э:"e",ю:"yu",я:"ya",А:"A",Б:"B",В:"V",Г:"G",Д:"D",Е:"E",Ё:"Yo",Ж:"Zh",З:"Z",И:"I",Й:"J",К:"K",Л:"L",М:"M",Н:"N",О:"O",П:"P",Р:"R",С:"S",Т:"T",У:"U",Ф:"F",Х:"H",Ц:"C",Ч:"Ch",Ш:"Sh",Щ:"Sh",Ъ:"",Ы:"Y",Ь:"",Э:"E",Ю:"Yu",Я:"Ya"};var UKRAINIAN_MAP={Є:"Ye",І:"I",Ї:"Yi",Ґ:"G",є:"ye",і:"i",ї:"yi",ґ:"g"};var CZECH_MAP={č:"c",ď:"d",ě:"e",ň:"n",ř:"r",š:"s",ť:"t",ů:"u",ž:"z",Č:"C",Ď:"D",Ě:"E",Ň:"N",Ř:"R",Š:"S",Ť:"T",Ů:"U",Ž:"Z"};var POLISH_MAP={ą:"a",ć:"c",ę:"e",ł:"l",ń:"n",ó:"o",ś:"s",ź:"z",ż:"z",Ą:"A",Ć:"C",Ę:"e",Ł:"L",Ń:"N",Ó:"o",Ś:"S",Ź:"Z",Ż:"Z"};var LATVIAN_MAP={ā:"a",č:"c",ē:"e",ģ:"g",ī:"i",ķ:"k",ļ:"l",ņ:"n",š:"s",ū:"u",ž:"z",Ā:"A",Č:"C",Ē:"E",Ģ:"G",Ī:"i",Ķ:"k",Ļ:"L",Ņ:"N",Š:"S",Ū:"u",Ž:"Z"};var ALL_DOWNCODE_MAPS=new Array;ALL_DOWNCODE_MAPS[0]=LATIN_MAP;ALL_DOWNCODE_MAPS[1]=LATIN_SYMBOLS_MAP;ALL_DOWNCODE_MAPS[2]=GREEK_MAP;ALL_DOWNCODE_MAPS[3]=TURKISH_MAP;ALL_DOWNCODE_MAPS[4]=RUSSIAN_MAP;ALL_DOWNCODE_MAPS[5]=UKRAINIAN_MAP;ALL_DOWNCODE_MAPS[6]=CZECH_MAP;ALL_DOWNCODE_MAPS[7]=POLISH_MAP;ALL_DOWNCODE_MAPS[8]=LATVIAN_MAP;var Downcoder=new Object;Downcoder.Initialize=function(){if(Downcoder.map)return;Downcoder.map={};Downcoder.chars="";for(var e in ALL_DOWNCODE_MAPS){var t=ALL_DOWNCODE_MAPS[e];for(var n in t){Downcoder.map[n]=t[n];Downcoder.chars+=n}}Downcoder.regex=new RegExp("["+Downcoder.chars+"]|[^"+Downcoder.chars+"]+","g")};downcode=function(e){Downcoder.Initialize();var t="";var n=e.match(Downcoder.regex);if(n){for(var i=0;i<n.length;i++){if(n[i].length==1){var a=Downcoder.map[n[i]];if(a!=null){t+=a;continue}}t+=n[i]}}else{t=e}return t};function URLify(e,t){e=downcode(e);removelist=["a","an","as","at","before","but","by","for","from","is","in","into","like","of","off","on","onto","per","since","than","the","this","that","to","up","via","with"];r=new RegExp("\\b("+removelist.join("|")+")\\b","gi");e=e.replace(r,"");e=e.replace(/[^-\w\s]/g,"");e=e.replace(/^\s+|\s+$/g,"");e=e.replace(/[-\s]+/g,"-");e=e.toLowerCase();return e.substring(0,t)}(function(e){e.fn.prepopulate=function(t,n){return this.each(function(){var i=e(this);i.data("_changed",false);i.change(function(){i.data("_changed",true)});var a=function(){if(i.data("_changed")==true)return;var a=[],r,s;t.each(function(){if(e(this).val().length>0){a.push(e(this).val())}});s=a.join(" ");r=URLify(s,n)||s;i.val(r)};t.change(a)})}})(jQuery);var swfobject=function(){var e="undefined",t="object",n="Shockwave Flash",i="ShockwaveFlash.ShockwaveFlash",a="application/x-shockwave-flash",r="SWFObjectExprInst",s="onreadystatechange",o=window,l=document,c=navigator,d=false,f=[O],u=[],p=[],h=[],v,m,g,w,y=false,b=false,k,x,T=true,S=function(){var r=typeof l.getElementById!=e&&typeof l.getElementsByTagName!=e&&typeof l.createElement!=e,s=c.userAgent.toLowerCase(),f=c.platform.toLowerCase(),u=f?/win/.test(f):/win/.test(s),p=f?/mac/.test(f):/mac/.test(s),h=/webkit/.test(s)?parseFloat(s.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,v=!+"1",m=[0,0,0],g=null;if(typeof c.plugins!=e&&typeof c.plugins[n]==t){g=c.plugins[n].description;if(g&&!(typeof c.mimeTypes!=e&&c.mimeTypes[a]&&!c.mimeTypes[a].enabledPlugin)){d=true;v=false;g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1");m[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10);m[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10);m[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof o.ActiveXObject!=e){try{var w=new ActiveXObject(i);if(w){g=w.GetVariable("$version");if(g){v=true;g=g.split(" ")[1].split(",");m=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}}}catch(y){}}}return{w3:r,pv:m,wk:h,ie:v,win:u,mac:p}}(),C=function(){if(!S.w3){return}if(typeof l.readyState!=e&&l.readyState=="complete"||typeof l.readyState==e&&(l.getElementsByTagName("body")[0]||l.body)){E()}if(!y){if(typeof l.addEventListener!=e){l.addEventListener("DOMContentLoaded",E,false)}if(S.ie&&S.win){l.attachEvent(s,function(){if(l.readyState=="complete"){l.detachEvent(s,arguments.callee);E()}});if(o==top){(function(){if(y){return}try{l.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}E()})()}}if(S.wk){(function(){if(y){return}if(!/loaded|complete/.test(l.readyState)){setTimeout(arguments.callee,0);return}E()})()}_(E)}}();function E(){if(y){return}try{var e=l.getElementsByTagName("body")[0].appendChild($("span"));e.parentNode.removeChild(e)}catch(t){return}y=true;var n=f.length;for(var i=0;i<n;i++){f[i]()}}function A(e){if(y){e()}else{f[f.length]=e}}function _(t){if(typeof o.addEventListener!=e){o.addEventListener("load",t,false)}else{if(typeof l.addEventListener!=e){l.addEventListener("load",t,false)}else{if(typeof o.attachEvent!=e){V(o,"onload",t)}else{if(typeof o.onload=="function"){var n=o.onload;o.onload=function(){n();t()}}else{o.onload=t}}}}}function O(){if(d){D()}else{I()}}function D(){var n=l.getElementsByTagName("body")[0];var i=$(t);i.setAttribute("type",a);var r=n.appendChild(i);if(r){var s=0;(function(){if(typeof r.GetVariable!=e){var t=r.GetVariable("$version");if(t){t=t.split(" ")[1].split(",");S.pv=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)]}}else{if(s<10){s++;setTimeout(arguments.callee,10);return}}n.removeChild(i);r=null;I()})()}else{I()}}function I(){var t=u.length;if(t>0){for(var n=0;n<t;n++){var i=u[n].id;var a=u[n].callbackFn;var r={success:false,id:i};if(S.pv[0]>0){var s=z(i);if(s){if(W(u[n].swfVersion)&&!(S.wk&&S.wk<312)){q(i,true);if(a){r.success=true;r.ref=L(i);a(r)}}else{if(u[n].expressInstall&&N()){var o={};o.data=u[n].expressInstall;o.width=s.getAttribute("width")||"0";o.height=s.getAttribute("height")||"0";if(s.getAttribute("class")){o.styleclass=s.getAttribute("class")}if(s.getAttribute("align")){o.align=s.getAttribute("align")}var l={};var c=s.getElementsByTagName("param");var d=c.length;for(var f=0;f<d;f++){if(c[f].getAttribute("name").toLowerCase()!="movie"){l[c[f].getAttribute("name")]=c[f].getAttribute("value")}}j(o,l,i,a)}else{M(s);if(a){a(r)}}}}}else{q(i,true);if(a){var p=L(i);if(p&&typeof p.SetVariable!=e){r.success=true;r.ref=p}a(r)}}}}}function L(n){var i=null;var a=z(n);if(a&&a.nodeName=="OBJECT"){if(typeof a.SetVariable!=e){i=a}else{var r=a.getElementsByTagName(t)[0];if(r){i=r}}}return i}function N(){return!b&&W("6.0.65")&&(S.win||S.mac)&&!(S.wk&&S.wk<312)}function j(t,n,i,a){b=true;g=a||null;w={success:false,id:i};var s=z(i);if(s){if(s.nodeName=="OBJECT"){v=P(s);m=null}else{v=s;m=i}t.id=r;if(typeof t.width==e||!/%$/.test(t.width)&&parseInt(t.width,10)<310){t.width="310"}if(typeof t.height==e||!/%$/.test(t.height)&&parseInt(t.height,10)<137){t.height="137"}l.title=l.title.slice(0,47)+" - Flash Player Installation";var c=S.ie&&S.win?"ActiveX":"PlugIn",d="MMredirectURL="+o.location.toString().replace(/&/g,"%26")+"&MMplayerType="+c+"&MMdoctitle="+l.title;if(typeof n.flashvars!=e){n.flashvars+="&"+d}else{n.flashvars=d}if(S.ie&&S.win&&s.readyState!=4){var f=$("div");i+="SWFObjectNew";f.setAttribute("id",i);s.parentNode.insertBefore(f,s);s.style.display="none";(function(){if(s.readyState==4){s.parentNode.removeChild(s)}else{setTimeout(arguments.callee,10)}})()}R(t,n,i)}}function M(e){if(S.ie&&S.win&&e.readyState!=4){var t=$("div");e.parentNode.insertBefore(t,e);t.parentNode.replaceChild(P(e),t);e.style.display="none";(function(){if(e.readyState==4){e.parentNode.removeChild(e)}else{setTimeout(arguments.callee,10)}})()}else{e.parentNode.replaceChild(P(e),e)}}function P(e){var n=$("div");if(S.win&&S.ie){n.innerHTML=e.innerHTML}else{var i=e.getElementsByTagName(t)[0];if(i){var a=i.childNodes;if(a){var r=a.length;for(var s=0;s<r;s++){if(!(a[s].nodeType==1&&a[s].nodeName=="PARAM")&&!(a[s].nodeType==8)){n.appendChild(a[s].cloneNode(true))}}}}}return n}function R(n,i,r){var s,o=z(r);if(S.wk&&S.wk<312){return s}if(o){if(typeof n.id==e){n.id=r}if(S.ie&&S.win){var l="";for(var c in n){if(n[c]!=Object.prototype[c]){if(c.toLowerCase()=="data"){i.movie=n[c]}else{if(c.toLowerCase()=="styleclass"){l+=' class="'+n[c]+'"'}else{if(c.toLowerCase()!="classid"){l+=" "+c+'="'+n[c]+'"'}}}}}var d="";for(var f in i){if(i[f]!=Object.prototype[f]){d+='<param name="'+f+'" value="'+i[f]+'" />'}}o.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+l+">"+d+"</object>";p[p.length]=n.id;s=z(n.id)}else{var u=$(t);u.setAttribute("type",a);for(var h in n){if(n[h]!=Object.prototype[h]){if(h.toLowerCase()=="styleclass"){u.setAttribute("class",n[h])}else{if(h.toLowerCase()!="classid"){u.setAttribute(h,n[h])}}}}for(var v in i){if(i[v]!=Object.prototype[v]&&v.toLowerCase()!="movie"){B(u,v,i[v])}}o.parentNode.replaceChild(u,o);s=u}}return s}function B(e,t,n){var i=$("param");i.setAttribute("name",t);i.setAttribute("value",n);e.appendChild(i)}function F(e){var t=z(e);if(t&&t.nodeName=="OBJECT"){if(S.ie&&S.win){t.style.display="none";(function(){if(t.readyState==4){U(e)}else{setTimeout(arguments.callee,10)}})()}else{t.parentNode.removeChild(t)}}}function U(e){var t=z(e);if(t){for(var n in t){if(typeof t[n]=="function"){t[n]=null}}t.parentNode.removeChild(t)}}function z(e){var t=null;try{t=l.getElementById(e)}catch(n){}return t}function $(e){return l.createElement(e)}function V(e,t,n){e.attachEvent(t,n);h[h.length]=[e,t,n]}function W(e){var t=S.pv,n=e.split(".");n[0]=parseInt(n[0],10);n[1]=parseInt(n[1],10)||0;n[2]=parseInt(n[2],10)||0;return t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?true:false}function H(n,i,a,r){if(S.ie&&S.mac){return}var s=l.getElementsByTagName("head")[0];if(!s){return}var o=a&&typeof a=="string"?a:"screen";if(r){k=null;x=null}if(!k||x!=o){var c=$("style");c.setAttribute("type","text/css");c.setAttribute("media",o);k=s.appendChild(c);if(S.ie&&S.win&&typeof l.styleSheets!=e&&l.styleSheets.length>0){k=l.styleSheets[l.styleSheets.length-1]}x=o}if(S.ie&&S.win){if(k&&typeof k.addRule==t){k.addRule(n,i)}}else{if(k&&typeof l.createTextNode!=e){k.appendChild(l.createTextNode(n+" {"+i+"}"))}}}function q(e,t){if(!T){return}var n=t?"visible":"hidden";if(y&&z(e)){z(e).style.visibility=n}else{H("#"+e,"visibility:"+n)}}function G(t){var n=/[\\\"<>\.;]/;var i=n.exec(t)!=null;return i&&typeof encodeURIComponent!=e?encodeURIComponent(t):t}var Q=function(){if(S.ie&&S.win){window.attachEvent("onunload",function(){var e=h.length;for(var t=0;t<e;t++){h[t][0].detachEvent(h[t][1],h[t][2])}var n=p.length;for(var i=0;i<n;i++){F(p[i])}for(var a in S){S[a]=null}S=null;for(var r in swfobject){swfobject[r]=null}swfobject=null})}}();return{registerObject:function(e,t,n,i){if(S.w3&&e&&t){var a={};a.id=e;a.swfVersion=t;a.expressInstall=n;a.callbackFn=i;u[u.length]=a;q(e,false)}else{if(i){i({success:false,id:e})}}},getObjectById:function(e){if(S.w3){return L(e)}},embedSWF:function(n,i,a,r,s,o,l,c,d,f){var u={success:false,id:i};if(S.w3&&!(S.wk&&S.wk<312)&&n&&i&&a&&r&&s){q(i,false);A(function(){a+="";r+="";var p={};if(d&&typeof d===t){for(var h in d){p[h]=d[h]}}p.data=n;p.width=a;p.height=r;var v={};if(c&&typeof c===t){for(var m in c){v[m]=c[m]}}if(l&&typeof l===t){for(var g in l){if(typeof v.flashvars!=e){v.flashvars+="&"+g+"="+l[g]}else{v.flashvars=g+"="+l[g]}}}if(W(s)){var w=R(p,v,i);if(p.id==i){q(i,true)}u.success=true;u.ref=w}else{if(o&&N()){p.data=o;j(p,v,i,f);return}else{q(i,true)}}if(f){f(u)}})}else{if(f){f(u)}}},switchOffAutoHideShow:function(){T=false},ua:S,getFlashPlayerVersion:function(){return{major:S.pv[0],minor:S.pv[1],release:S.pv[2]}},hasFlashPlayerVersion:W,createSWF:function(e,t,n){if(S.w3){return R(e,t,n)}else{return undefined}},showExpressInstall:function(e,t,n,i){if(S.w3&&N()){j(e,t,n,i)}},removeSWF:function(e){if(S.w3){F(e)}},createCSS:function(e,t,n,i){if(S.w3){H(e,t,n,i)}},addDomLoadEvent:A,addLoadEvent:_,getQueryParamValue:function(e){var t=l.location.search||l.location.hash;if(t){if(/\?/.test(t)){t=t.split("?")[1]}if(e==null){return G(t)}var n=t.split("&");for(var i=0;i<n.length;i++){if(n[i].substring(0,n[i].indexOf("="))==e){return G(n[i].substring(n[i].indexOf("=")+1))}}}return""},expressInstallCallback:function(){if(b){var e=z(r);if(e&&v){e.parentNode.replaceChild(v,e);if(m){q(m,true);if(S.ie&&S.win){v.style.display="block"}}if(g){g(w)}}b=false}}}}();(function(e){e.fn.lazyload=function(n){var a=e.extend(e.fn.lazyload.defaults,n);var r=this;var s=false;loaded=r.length;e(window).bind("scroll",function(e){s=true});i(r,a,null);e(window).trigger("scroll");var o=window.location.hash;t();var l=setInterval(function(){if(loaded<=0){e(window).unbind("scroll");clearInterval(l);return}if(s){s=false;if(o!=window.location.hash){assocAnchor=window.location.hash;o=window.location.hash}else{assocAnchor=null}loadedCount=i(r,a,assocAnchor);loaded-=loadedCount}},250);return this};e.fn.lazyload.defaults={threshold:750};function t(){if(window.location.hash){window.location.hash=window.location.hash}}function n(t,n){var i=e(window).height()+e(window).scrollTop();return i>=e(t).offset().top-n["threshold"]}e.fn.lazyload.loadOriginalImage=function(n,i){if(i!=null){e(n).load(function(){t()})}e(n).attr("src",e(n).data("original-src")).removeData("original-src")};e.fn.loadnow=function(t){var n=this;n.each(function(){e.fn.lazyload.loadOriginalImage(this);e(this).removeClass("lazy")})};function i(t,i,a){var r=0;t.filter(".lazy").each(function(){if(e(this).hasClass("lazy")&&n(this,i)&&e(this).data("original-src")&&e(this).is(":visible")){e.fn.lazyload.loadOriginalImage(this,a);e(this).removeClass("lazy");r++}});return r}})(jQuery);(function(e){var t={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",prePopulate:null,processPrePopulate:false,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:true,theme:null,resultsFormatter:function(e){return"<li>"+e[this.propertyToSearch]+"</li>"},tokenFormatter:function(e){return"<li><p>"+e[this.propertyToSearch]+"</p></li>"
},tokenLimit:null,tokenDelimiter:",",preventDuplicates:false,tokenValue:"id",onResult:null,onAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:false};var n={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",disabled:"token-input-disabled"};var i={BEFORE:0,AFTER:1,END:2};var a={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};var r={init:function(n,i){var a=e.extend({},t,i||{});return this.each(function(){e(this).data("tokenInputObject",new e.TokenList(this,n,a))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(e){this.data("tokenInputObject").add(e);return this},remove:function(e){this.data("tokenInputObject").remove(e);return this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(e){this.data("tokenInputObject").toggleDisabled(e);return this}};e.fn.tokenInput=function(e){if(r[e]){return r[e].apply(this,Array.prototype.slice.call(arguments,1))}else{return r.init.apply(this,arguments)}};e.TokenList=function(t,r,s){if(e.type(r)==="string"||e.type(r)==="function"){s.url=r;var o=H();if(s.crossDomain===undefined){if(o.indexOf("://")===-1){s.crossDomain=false}else{s.crossDomain=location.href.split(/\/+/g)[1]!==o.split(/\/+/g)[1]}}}else if(typeof r==="object"){s.local_data=r}if(s.classes){s.classes=e.extend({},n,s.classes)}else if(s.theme){s.classes={};e.each(n,function(e,t){s.classes[e]=t+"-"+s.theme})}else{s.classes=n}var l=[];var c=0;var d=new e.TokenList.Cache;var f;var u;var p=e('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",s.idPrefix+t.id).focus(function(){if(s.disabled){return false}else if(s.tokenLimit===null||s.tokenLimit!==c){R()}}).blur(function(){j();e(this).val("")}).bind("keyup keydown blur update",C).keydown(function(t){var n;var r;switch(t.keyCode){case a.LEFT:case a.RIGHT:case a.UP:case a.DOWN:if(!e(this).val()){n=y.prev();r=y.next();if(n.length&&n.get(0)===v||r.length&&r.get(0)===v){if(t.keyCode===a.LEFT||t.keyCode===a.UP){D(e(v),i.BEFORE)}else{D(e(v),i.AFTER)}}else if((t.keyCode===a.LEFT||t.keyCode===a.UP)&&n.length){O(e(n.get(0)))}else if((t.keyCode===a.RIGHT||t.keyCode===a.DOWN)&&r.length){O(e(r.get(0)))}}else{var s=null;if(t.keyCode===a.DOWN||t.keyCode===a.RIGHT){s=e(g).next()}else{s=e(g).prev()}if(s.length){z(s)}return false}break;case a.BACKSPACE:n=y.prev();if(!e(this).val().length){if(v){L(e(v));h.change()}else if(n.length){O(e(n.get(0)))}return false}else if(e(this).val().length===1){j()}else{setTimeout(function(){V()},5)}break;case a.TAB:case a.ENTER:case a.NUMPAD_ENTER:case a.COMMA:if(g){_(e(g).data("tokeninput"));h.change();return false}break;case a.ESCAPE:j();return true;default:if(String.fromCharCode(t.which)){setTimeout(function(){V()},5)}break}});var h=e(t).hide().val("").focus(function(){p.focus()}).blur(function(){p.blur()});var v=null;var m=0;var g=null;var w=e("<ul />").addClass(s.classes.tokenList).click(function(t){var n=e(t.target).closest("li");if(n&&n.get(0)&&e.data(n.get(0),"tokeninput")){I(n)}else{if(v){D(e(v),i.END)}p.focus()}}).mouseover(function(t){var n=e(t.target).closest("li");if(n&&v!==this){n.addClass(s.classes.highlightedToken)}}).mouseout(function(t){var n=e(t.target).closest("li");if(n&&v!==this){n.removeClass(s.classes.highlightedToken)}}).insertBefore(h);var y=e("<li />").addClass(s.classes.inputToken).appendTo(w).append(p);var b=e("<div>").addClass(s.classes.dropdown).appendTo("body").hide();var k=e("<tester/>").insertAfter(p).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:p.css("fontSize"),fontFamily:p.css("fontFamily"),fontWeight:p.css("fontWeight"),letterSpacing:p.css("letterSpacing"),whiteSpace:"nowrap"});h.val("");var x=s.prePopulate||h.data("pre");if(s.processPrePopulate&&e.isFunction(s.onResult)){x=s.onResult.call(h,x)}if(x&&x.length){e.each(x,function(e,t){A(t);S()})}if(s.disabled){T(true)}if(e.isFunction(s.onReady)){s.onReady.call()}this.clear=function(){w.children("li").each(function(){if(e(this).children("input").length===0){L(e(this))}})};this.add=function(e){_(e)};this.remove=function(t){w.children("li").each(function(){if(e(this).children("input").length===0){var n=e(this).data("tokeninput");var i=true;for(var a in t){if(t[a]!==n[a]){i=false;break}}if(i){L(e(this))}}})};this.getTokens=function(){return l};this.toggleDisabled=function(e){T(e)};function T(t){if(typeof t==="boolean"){s.disabled=t}else{s.disabled=!s.disabled}p.prop("disabled",s.disabled);w.toggleClass(s.classes.disabled,s.disabled);if(v){D(e(v),i.END)}h.prop("disabled",s.disabled)}function S(){if(s.tokenLimit!==null&&c>=s.tokenLimit){p.hide();j();return}}function C(){if(u===(u=p.val())){return}var e=u.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");k.html(e);p.width(k.width()+30)}function E(e){return e>=48&&e<=90||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222}function A(t){var n=s.tokenFormatter(t);n=e(n).addClass(s.classes.token).insertBefore(y);e("<span>"+s.deleteText+"</span>").addClass(s.classes.tokenDelete).appendTo(n).click(function(){if(!s.disabled){L(e(this).parent());h.change();return false}});var i=t;e.data(n.get(0),"tokeninput",t);l=l.slice(0,m).concat([i]).concat(l.slice(m));m++;N(l,h);c+=1;if(s.tokenLimit!==null&&c>=s.tokenLimit){p.hide();j()}return n}function _(t){var n=s.onAdd;if(c>0&&s.preventDuplicates){var i=null;w.children().each(function(){var n=e(this);var a=e.data(n.get(0),"tokeninput");if(a&&a.id===t.id){i=n;return false}});if(i){O(i);y.insertAfter(i);p.focus();return}}if(s.tokenLimit==null||c<s.tokenLimit){A(t);S()}p.val("");j();if(e.isFunction(n)){n.call(h,t)}}function O(e){if(!s.disabled){e.addClass(s.classes.selectedToken);v=e.get(0);p.val("");j()}}function D(e,t){e.removeClass(s.classes.selectedToken);v=null;if(t===i.BEFORE){y.insertBefore(e);m--}else if(t===i.AFTER){y.insertAfter(e);m++}else{y.appendTo(w);m=c}p.focus()}function I(t){var n=v;if(v){D(e(v),i.END)}if(n===t.get(0)){D(t,i.END)}else{O(t)}}function L(t){var n=e.data(t.get(0),"tokeninput");var i=s.onDelete;var a=t.prevAll().length;if(a>m)a--;t.remove();v=null;p.focus();l=l.slice(0,a).concat(l.slice(a+1));if(a<m)m--;N(l,h);c-=1;if(s.tokenLimit!==null){p.show().val("").focus()}if(e.isFunction(i)){i.call(h,n)}}function N(t,n){var i=e.map(t,function(e){if(typeof s.tokenValue=="function")return s.tokenValue.call(this,e);return e[s.tokenValue]});n.val(i.join(s.tokenDelimiter))}function j(){b.hide().empty();g=null}function M(){b.css({position:"absolute",top:e(w).offset().top+e(w).outerHeight(),left:e(w).offset().left,width:e(w).width(),"z-index":999}).show()}function P(){if(s.searchingText){b.html("<p>"+s.searchingText+"</p>");M()}}function R(){if(s.hintText){b.html("<p>"+s.hintText+"</p>");M()}}function B(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")}function F(e,t,n){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t+")(?![^<>]*>)(?![^&;]+;)","g"),B(t,n))}function U(t,n){if(n&&n.length){b.empty();var i=e("<ul>").appendTo(b).mouseover(function(t){z(e(t.target).closest("li"))}).mousedown(function(t){_(e(t.target).closest("li").data("tokeninput"));h.change();return false}).hide();e.each(n,function(n,a){var r=s.resultsFormatter(a);r=F(r,a[s.propertyToSearch],t);r=e(r).appendTo(i);if(n%2){r.addClass(s.classes.dropdownItem)}else{r.addClass(s.classes.dropdownItem2)}if(n===0){z(r)}e.data(r.get(0),"tokeninput",a)});M();if(s.animateDropdown){i.slideDown("fast")}else{i.show()}}else{if(s.noResultsText){b.html("<p>"+s.noResultsText+"</p>");M()}}}function z(t){if(t){if(g){$(e(g))}t.addClass(s.classes.selectedDropdownItem);g=t.get(0)}}function $(e){e.removeClass(s.classes.selectedDropdownItem);g=null}function V(){var t=p.val();if(t&&t.length){if(v){D(e(v),i.AFTER)}if(t.length>=s.minChars){P();clearTimeout(f);f=setTimeout(function(){W(t)},s.searchDelay)}else{j()}}}function W(t){var n=t+H();var i=d.get(n);if(i){U(t,i)}else{if(s.url){var a=H();var r={};r.data={};if(a.indexOf("?")>-1){var o=a.split("?");r.url=o[0];var l=o[1].split("&");e.each(l,function(e,t){var n=t.split("=");r.data[n[0]]=n[1]})}else{r.url=a}r.data[s.queryParam]=t;r.type=s.method;r.dataType=s.contentType;if(s.crossDomain){r.dataType="jsonp"}r.success=function(i){if(e.isFunction(s.onResult)){i=s.onResult.call(h,i)}d.add(n,s.jsonContainer?i[s.jsonContainer]:i);if(p.val()===t){U(t,s.jsonContainer?i[s.jsonContainer]:i)}};e.ajax(r)}else if(s.local_data){var c=e.grep(s.local_data,function(e){return e[s.propertyToSearch].toLowerCase().indexOf(t.toLowerCase())>-1});if(e.isFunction(s.onResult)){c=s.onResult.call(h,c)}d.add(n,c);U(t,c)}}}function H(){var e=s.url;if(typeof s.url=="function"){e=s.url.call(s)}return e}};e.TokenList.Cache=function(t){var n=e.extend({max_size:500},t);var i={};var a=0;var r=function(){i={};a=0};this.add=function(e,t){if(a>n.max_size){r()}if(!i[e]){a+=1}i[e]=t};this.get=function(e){return i[e]}}})(jQuery);(function(e){"use strict";function t(){function t(e,t){t=(t+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var n=new RegExp("("+t+")","gi");return e.replace(n,"<strong>$1</strong>")}var n=[];if(e("#id_to").val()){n=[{username:k.safeString(e("#id_to").val()),display_name:null}]}var i={theme:"facebook",hintText:gettext("Search for a user..."),queryParam:"term",propertyToSearch:"username",tokenValue:"username",prePopulate:n,resultsFormatter:function(t){var n=e("#token-input-id_to").val();if(t.display_name){return k.safeInterpolate('<li><div class="name_search">%(display_name)s [%(username)s]</div></li>',t,true)}return k.safeInterpolate('<li><div class="name_search">%(username)s</div></li>',t,true)},onAdd:function(t){e(this).closest(".single").closest("form").submit()}};e("input.user-autocomplete").tokenInput(e("body").data("usernames-api"),i)}e(document).ready(t)})(jQuery);(function(){var e="video-flash-",t=0,n="9.0.0",i={allowfullscreen:"true"},a={autoload:1,showtime:1,showvolume:1};function r(r){if(r[0].tagName.toUpperCase()!=="VIDEO")return;var s={ogg:false,webm:false},o,l=Number(r.data("width")),c=Number(r.data("height")),d=e+t,f;t++;r.attr("id",d);$("source",r).each(function u(){for(o in s){if($(this).attr("type").indexOf(o)>-1){s[o]=true}}});if(Modernizr.video&&(s.webm&&Modernizr.video.webm)||s.ogg&&Modernizr.video.ogg){return false}f=r.data("fallback");if(f.substr(-4)===".swf"){swfobject.embedSWF(f,d,l,c,n,k.STATIC_URL+"/media/swf/expressInstall.swf",a,i)}else if(f){a.flv=f;swfobject.embedSWF(k.STATIC_URL+"swf/screencast.swf",d,l,c,n,k.STATIC_URL+"/media/swf/expressInstall.swf",a,i)}else{r.hide()}}function s(){$("div.video video").each(function e(t){r($(this))})}$(document).ready(function(){s()});k.initVideo=s})();(function(e){"use strict";function t(t){this.$container=t||e("body");this.state={};this.loadData();this.initEvents();this.updateUI();this.updateState();this.wrapTOCs();this.initShowFuncs();this.showAndHide()}t.prototype.productShortMap={fx:"firefox",m:"mobile",fxos:"firefox-os",tb:"thunderbird"};t.prototype.loadData=function(){this.data=JSON.parse(this.$container.find(".showfor-data").html());this.productSlugs=this.data.products.map(function(e){return e.slug});this.platformSlugs=[];for(var e in this.data.platforms){this.data.platforms[e].forEach(function(e){this.platformSlugs.push(e.slug)}.bind(this))}this.versionSlugs={};for(var t in this.data.versions){this.data.versions[t].forEach(function(e){this.versionSlugs[e.slug]=t}.bind(this))}};t.prototype.initEvents=function(){window.onpopstate=this.updateUI.bind(this);this.$container.on("change keyup","input, select",this.onUIChange.bind(this))};t.prototype.ensureSelect=function(t,n,i,a){var r;var s;var o={};var l;function c(e,t){for(var n=0;n<e.length;n++){if(e[n].slug===t){return e[n]}}return null}if(n==="version"){l=c(this.data.versions[i],a);if(l!==null){o["data-min"]=l.min_version;o["data-max"]=l.max_version}}else if(n==="platform"){l=c(this.data.platforms[i],a)}else if(n==="product"){l=c(this.data.products,a)}else{throw new Error("Unknown showfor select type "+n)}if(l===null){return}a=n+":"+a;if(t.find('option[value="'+a+'"]').length===0){r=e("<option>").attr("value",a).text(l.name);for(s in o){r.attr(s,o[s])}t.append(r)}t.val(a)};t.prototype.updateUI=function(){var t=null;var n=document.location.hash;if(n.indexOf(":")>=0){t=n.slice(1)}if(t===null&&window.sessionStorage){t=sessionStorage.getItem("showfor::persist")}if(t){var i=false;this.$container.find(".product input[type=checkbox]").prop("checked",false);t.split("&").forEach(function(e){var t=e.split(":");var n=t[0]||null;var a=t[1]||null;var r=t[2]||null;var s=this.$container.find('.product[data-product="'+n+'"]');if(s.length===0){return}i=true;s.find('input[type=checkbox][value="product:'+n+'"]').prop("checked",true);if(a){var o=s.find("select.platform");this.ensureSelect(o,"platform",n,a)}if(r){var l=s.find("select.version");this.ensureSelect(l,"version",n,r)}}.bind(this));if(i){return}}var a=this.productShortMap[BrowserDetect.browser]||BrowserDetect.browser;var r=this.productShortMap[BrowserDetect.OS]||BrowserDetect.OS;var s=BrowserDetect.version;var o=this.$container.find(".product");var l={};o.each(function(t,n){var i=e(n);l[i.data("product")]=i});var c,d;if(s){if(a==="firefox"&&this.productSlugs.indexOf("firefox")!==-1){c="fx"+s;d=l.firefox.find("select.version");this.ensureSelect(d,"version","firefox",c)}else if(a==="mobile"&&this.productSlugs.indexOf("mobile")!==-1){c="m"+s;d=l.mobile.find("select.version");this.ensureSelect(d,"version","mobile",c)}else if(a==="firefox-os"&&this.productSlugs.indexOf("firefox-os")!==-1){c="fxos"+s.toFixed(1);d=l["firefox-os"].find("select.version");this.ensureSelect(d,"version","firefox-os",c)}}o.find("select.platform").each(function(t,n){var i=e(n);var a=i.parents(".product").data("product");this.ensureSelect(i,"platform",a,r)}.bind(this))};t.prototype.onUIChange=function(){this.updateState();this.showAndHide();this.persist()};t.prototype.persist=function(){var e,t,n=0;var i="";for(e in this.state){t=this.state[e];if(t.enabled){if(n>0){i+="&"}var a=t.platform||"";var r=t.version?t.version.slug||"":"";i+=e+":"+a+":"+r;n++}}if(i===""){return}if(document.location.hash===""||document.location.hash.indexOf(":")>=0){history.replaceState(this.state,i,"#"+i)}if(window.sessionStorage){window.sessionStorage.setItem("showfor::persist",i)}};t.prototype.updateState=function(){this.state={};this.$container.find(".product").each(function(t,n){var i=e(n);var a=i.data("product");this.state[a]={enabled:i.find("input[type=checkbox]").prop("checked")};i.find("select").each(function(t,n){var i=e(n);var r=i.val();var s=r.split(":");var o=s[0];var l=s[1];if(o==="version"){var c=i.find("option:selected");l={slug:l,min:parseFloat(c.data("min")),max:parseFloat(c.data("max"))}}this.state[a][o]=l}.bind(this))}.bind(this))};t.prototype.wrapTOCs=function(){this.$container.find("#toc a").each(function(t,n){var i=e(n);var a=i.attr("href");if(a[0]!=="#"){return}var r=e(a);var s=i.parent();while(r.length){if(r.hasClass("for")){var o=e("<span/>",{"class":"for","data-for":r.data("for")});s=s.wrap(o)}r=r.parent()}})};t.prototype.initShowFuncs=function(){this.$container.find(".for").each(function(t,n){var i=e(n);var a=i.data("for");var r=a.split(/\s*,\s*/);var s=this.matchesCriteria.bind(this,r);i.data("show-func",s)}.bind(this))};t.prototype.showAndHide=function(){this.$container.find(".for").each(function(t,n){var i=e(n);var a=i.data("show-func");if(a){i.toggle(a())}else{i.show()}}.bind(this))};t.prototype.matchesCriteria=function(e){var t=false;var n=false;var i=false;var a=false;var r=[];for(var s in this.state){var o=this.state[s];if(o.enabled&&o.platform){r.push(o.platform)}}e.forEach(function(e){var s,o;var l=e.indexOf("not")===0;if(l){e=e.replace(/^not ?/,"")}e=this.productShortMap[e]||e;var c=">=";if(e[0]==="="){e=e.slice(1);c="="}if(this.productSlugs.indexOf(e)>=0){t=true;if(this.state[e].enabled!==l){n=true}}else if(this.versionSlugs[e]!==undefined){s=this.versionSlugs[e];t=true;o=parseFloat(/^[a-z]+([\d\.]+)$/.exec(e)[1]);var d=this.state[s].version.min;var f=this.state[s].version.max;var u=this.state[s].enabled;var p=c===">="&&o<f||c==="="&&o>=d&&o<f;if((u&&p)!==l){n=true}}else if(this.platformSlugs.indexOf(e)>=0){i=true;if(r.indexOf(e)>=0!==l){a=true}}else if(e==="win"){i=true;var h=["winxp","win7","win8"];var v=false;h.forEach(function(e){if(r.indexOf(e)>=0){v=true}});if(v!==l){a=true}}}.bind(this));return(!t||n)&&(!i||a)};window.ShowFor=t})(jQuery);(function(e){"use strict";function t(e,n){t.prototype.init.call(this,e,n)}t.prototype={init:function(t,n){var i=this,a=e(t),r=a.find('input[type="submit"], .btn[data-type="submit"]');n=e.extend({positionMessage:false,removeForm:false,replaceFormWithMessage:false},n);i.options=n;i.voted=false;i.$form=a;r.click(function(t){if(!i.voted){var n=e(this),a=n.closest("form"),s=a.attr("action"),o=a.serializeArray(),l={},c,d;r.attr("disabled","disabled");a.addClass("busy");for(c=0,d=o.length;c<d;c++){l[o[c].name]=o[c].value}l[n.attr("name")]=n.val();e.ajax({url:s,type:"POST",data:l,dataType:"json",success:function(t){if(t.survey){i.showSurvey(t.survey,a.parent())}if(t.message){i.showMessage(t.message,n,a)}n.addClass("active");r.removeAttr("disabled");a.removeClass("busy");i.voted=true;if(!l.ignored){e(document).trigger("vote",e.extend(l,{url:s}))}i.$form.filter(function(){return!a.is(this)}).remove()},error:function(){var e=gettext("There was an error submitting your vote.");i.showMessage(e,n);r.removeAttr("disabled");a.removeClass("busy")}})}e(this).blur();t.preventDefault();return false})},showMessage:function(t,n,i){var a=this,r=e('<div class="ajax-vote-box"><p class="msg"></p></div>'),s=n.offset();r.find("p").html(t);if(a.options.positionMessage){e("body").append(r);r.css({top:s.top-r.height()-30,left:s.left+n.width()/2-r.width()/2});var o=setTimeout(l,1e4);e("body").one("click",l)}else if(a.options.replaceFormWithMessage){i.replaceWith(r.removeClass("ajax-vote-box"))}else{n.parent().parent().addClass(n.val()).append(r)}function l(){r.fadeOut(function(){r.remove()});if(a.options.removeForm){a.$form.fadeOut(function(){a.$form.remove()})}e("body").unbind("click",l);clearTimeout(o)}},showSurvey:function(t,n){var i=e(t);var a=i.find("#remaining-characters");var r=i.find("textarea");var s=parseInt(a.text(),10);var o=i.find("input[type=radio][name=unhelpful-reason]");var l=i.find("input[type=submit], .btn[data-type=submit]");var c=i.find(".disabled-reason");var d=i.find("textarea");n.after(i);if(n.closest("aside").length){n.remove()}l.prop("disabled",true);function f(){var e=o.filter(":checked").val();var t=d.val();if(e===undefined||(e==="other"||e==="firefox-feedback")&&!t){l.prop("disabled",true);c.fadeIn(600)}else{l.prop("disabled",false);c.fadeOut(600)}}r.bind("input",function(){var e=r.val().length;var t;if(s-e>=0){a.text(s-e)}else{a.text(0);r.val(r.val().substr(0,s))}f()});o.bind("change",f);new k.AjaxVote(i.find("form"),{replaceFormWithMessage:true})}};window.k=window.k||{};window.k.AjaxVote=t})(jQuery);(function(e){"use strict";function t(e,n){t.prototype.init.call(this,e,n)}t.prototype={init:function(t,n){var i=this,a=e(t),r=n||{},s=r.previewUrl||a.data("preview-url"),o=r.previewElement&&e(r.previewElement)||e("#"+a.data("preview-container-id")),l=r.contentElement&&e(r.contentElement)||e("#"+a.data("preview-content-id")),c=a.closest("form").find("input[name=csrfmiddlewaretoken]").val(),d=a.closest("form").find("input[name=slug]").val(),f=a.closest("form").find("input[name=locale]").val(),u=r.changeHash===undefined?true:r.changeHash;a.click(function(t){t.preventDefault();e(this).attr("disabled","disabled");e(i).trigger("get-preview")});e(i).bind("get-preview",function(t){e.ajax({url:s,type:"POST",data:{content:l.val(),slug:d,locale:f,csrfmiddlewaretoken:c},dataType:"html",success:function(t){e(i).trigger("show-preview",[true,t])},error:function(){var t=gettext("There was an error generating the preview.");e(i).trigger("show-preview",[false,t])}})});e(i).bind("show-preview",function(t,n,r){o.html(r);if(u){document.location.hash=o.attr("id")}a.removeAttr("disabled");e("img.lazy").loadnow();e(i).trigger("done",[n])})}};window.k=window.k||{};window.k.AjaxPreview=t})(jQuery);(function(e){function t(){var t=e("body");e("select.enable-if-js").removeAttr("disabled");r();i();if(t.is(".document")){e("#support-search input[name=q]").val(k.unquote(e.cookie("last_search")));new ShowFor;v();new k.AjaxVote(".document-vote form",{positionMessage:true});d()}else if(t.is(".review")){new ShowFor;m();e("img.lazy").loadnow();e("#actions input").removeAttr("disabled")}if(t.is(".edit, .new, .translate")){e("#id_comment").keypress(function(t){if(t.which==13){e(this).blur();e(this).closest("form").find("input[type=submit]").focus().click();return false}});S();o();l();c();f();m();s();b();y();e("img.lazy").loadnow();e(".submit input").removeAttr("disabled")}if(t.is(".edit, .new")){e(function(){e("#accordion").accordion({collapsible:true,heightStyle:"content",active:false})})}if(t.is(".translate")){x()}w();u();Marky.createFullToolbar(".editor-tools","#id_content");h();n();T();e("img.lazy").lazyload()}function n(){if(e("#approve-modal").length>0){var t=function(t){if(t.target.id==="id_significance_0"){e("#id_is_ready_for_localization").parent().hide()}else{e("#id_is_ready_for_localization").parent().show()}};e("#id_significance_0").click(t);e("#id_significance_1").click(t);e("#id_significance_2").click(t)}}function i(){if(!("open"in document.createElement("details"))){document.documentElement.className+=" no-details"}if(!("open"in document.createElement("details"))){e("details").each(function(){var t=e(this),n=e("summary",t),i=t.children(":not(summary)"),a=t.contents(":not(summary)");if(!n.length){n=e(document.createElement("summary")).text("Details").prependTo(t)}if(i.length!==a.length){a.filter(function(){return this.nodeType===3&&/[^\t\n\r ]/.test(this.data)}).wrap("<span>");i=t.children(":not(summary)")}if(typeof t.attr("open")!=="undefined"){t.addClass("open");i.show()}else{i.hide()}n.attr("tabindex",0).click(function(){n.focus();if(typeof t.attr("open")!=="undefined"){t.removeAttr("open")}else{t.attr("open","open")}i.slideToggle();t.toggleClass("open")}).keyup(function(t){if(13===t.keyCode||32===t.keyCode){if(!(e.browser.opera&&13===t.keyCode)){t.preventDefault();n.click()}}})})}}function a(){function e(e,t){if(e===undefined||t===undefined||!VERSIONS[e]){return}for(var n=0;n<VERSIONS[e].length;n++){if(t<VERSIONS[e][n][0]){return e+VERSIONS[e][n][1]}}}return e(BrowserDetect.browser,BrowserDetect.version)}function r(){var t={title:{id:"#id_slug",dependency_ids:["#id_title"],dependency_list:["#id_title"],maxLength:50}};e.each(t,function(t,n){e(n.id).addClass("prepopulated_field");e(n.id).data("dependency_list",n.dependency_list).prepopulate(e(n.dependency_ids.join(",")),n.maxLength)})}function s(){var t=e("#remaining-characters"),n=e("#id_summary"),i=160,a=t.text(),r=function(){var e=n.val().length;t.text(i-e);if(i-e>=0){t.css("color","black")}else{t.css("color","red");if(e>=a){n.val(n.val().substr(0,a))}}};r();n.bind("input",r)}function o(){var t=e("#preview"),n=e("#preview-bottom"),i=new k.AjaxPreview(e(".btn-preview"),{contentElement:e("#id_content"),previewElement:t});e(i).bind("done",function(i,a){if(a){n.show();new ShowFor;t.find("select.enable-if-js").removeAttr("disabled");t.find(".kbox").kbox();k.initVideo();e("#preview-diff .output").empty()}})}function l(){var t=e("#preview-diff"),n=e("#preview-bottom"),i=e(".btn-diff");t.addClass("diff-this");i.click(function(){t.find(".to").text(e("#id_content").val());k.initDiff(t.parent());n.show();e("#preview").empty()})}function c(){e("#id_title").change(function(){var i=e(this),a=i.closest("form"),r=i.val(),s=e("#id_slug").val();t(r,a);n(s,a)});e("#id_slug").change(function(){var t=e(this),i=t.closest("form"),a=e("#id_slug").val();n(a,i)});function t(t,n){var a=gettext("A document with this title already exists in this locale.");i("title",t,e("#id_title"),n,a)}function n(t,n){var a=gettext("A document with this slug already exists in this locale.");i("slug",t,e("#id_slug"),n,a)}function i(t,n,i,a,r){i.removeClass("error");i.parent().find("ul.errorlist").remove();var s={};s[t]=n;e.ajax({url:a.data("json-url"),type:"GET",data:s,dataType:"json",success:function(t){var n=a.data("document-id");if(!n||t.id&&t.id!==parseInt(n)){i.addClass("error");i.before(e('<ul class="errorlist"><li/></ul>').find("li").text(r).end())}},error:function(e,t){if(e.status===404){}else{}}})}}function d(){var t=e("#banner"),n={top:-100},i={top:-10};if(t.length>0){setTimeout(function(){t.css({display:"block"}).css(n).animate(i,500).find("a.close").click(function(e){e.preventDefault();t.animate(n,500,"swing",function(){t.css({display:"none"})})})},500)}}function f(){var t=e("#submit-modal"),n=t.data("kbox");n.updateOptions({preOpen:function(){var n=e(".btn-submit").closest("form")[0];if(n.checkValidity&&!n.checkValidity()){t.find('button[type="submit"]').click();return false}t.find("#id_comment").attr("required",true);return true},preClose:function(){t.find("#id_comment").removeAttr("required");return true}})}function u(){e("div.revision-diff").each(function(){var t=e(this);t.find("div.picker a").unbind().click(function(n){n.preventDefault();e.ajax({url:e(this).attr("href"),type:"GET",dataType:"html",success:function(e){var n=new KBox(e,{modal:true,id:"diff-picker-kbox",closeOnOutClick:true,destroy:true,title:gettext("Choose revisions to compare")});n.open();p(n.$kbox.find("form"),n,t)},error:function(){var e=gettext("There was an error.");alert(e)}})})})}function p(t,n,i){t.submit(function(a){a.preventDefault();e.ajax({url:t.attr("action"),type:"GET",data:t.serialize(),dataType:"html",success:function(e){var t=i.parent();n.close();i.replaceWith(e);u();k.initDiff()}})})}function h(){var t=e("#revision-list div.l10n"),n,i;t.find("a.markasready").click(function(){var t=e(this);n=t.data("url");i=t.attr("id");e("#ready-for-l10n-modal span.revtime").html("("+t.data("revdate")+")")});e("#ready-for-l10n-modal input[type=submit], #ready-for-l10n-modal button[type=submit]").click(function(){var t=e("#ready-for-l10n-modal input[name=csrfmiddlewaretoken]").val(),a=e("#ready-for-l10n-modal").data("kbox");if(n!=undefined&&i!=undefined){e.ajax({type:"POST",url:n,data:{csrfmiddlewaretoken:t},success:function(t){e("#"+i).removeClass("markasready").addClass("yes");e("#"+i).unbind("click");a.close()},error:function(){a.close()}})}})}function v(){var t=k.getQueryParamsAsDict(),n=k.getReferrer(t),i=k.getSearchQuery(t,n);e(".document-vote form").append(e('<input type="hidden" name="referrer"/>').attr("value",n)).append(e('<input type="hidden" name="query"/>').attr("value",i))}function m(){var t=e("#id_needs_change"),n=e("#document-form li.comment,#approve-modal div.comment");if(t.length>0){i();t.change(i)}function i(){if(t.is(":checked")){n.slideDown();n.find("textarea").attr("required","required")}else{n.hide();n.find("textarea").removeAttr("required")}}}function g(){e(".watch-form").click(function(){var t=e(this);e.post(t.attr("action"),t.serialize(),function(){t.find(".watchtoggle").toggleClass("on")}).error(function(){});return false})}function w(){e("#quick-links .edit a").click(function(t){t.preventDefault();e("#doc-tabs").slideToggle("fast",function(){e("body").toggleClass("show-editing-tools")});if(e(this).is(".show")){e.cookie("show-editing-tools",1,{path:"/"})}else{e.cookie("show-editing-tools",null,{path:"/"})}})}function y(){window.highlighting={};var t=e("<div id='editor'></div>");var n=e("<div id='editor_wrapper'></div>");var i=function(){var t=window.highlighting.session;if(!t)return;var n=e("#id_content").val();t.setValue(n)};window.highlighting.updateEditor=i;var a=e("<a></a>").text(gettext("Toggle syntax highlighting")).css({cssFloat:"right",cursor:"pointer"}).toggle(function(){n.css("display","none");e("#id_content").css("display","block")},function(){i();n.css("display","block");e("#id_content").css("display","none")});var r=function(){return n.css("display")=="block"};window.highlighting.isEnabled=r;n.append(t);e("#id_content").after(a).after(n).hide();window.addEventListener("load",function(){var t=ace.edit("editor");window.highlighting.editor=t;var n=t.getSession();window.highlighting.session=n;n.setMode("ace/mode/sumo");n.setUseWrapMode(true);ace.config.loadModule("ace/ext/language_tools",function(){t.setOptions({enableBasicAutocompletion:true,enableSnippets:true})});e("#id_content").bind("keyup",i);i();n.on("change",function(t){if(!r())return;e("#id_content").val(n.getValue())})},false)}function b(){var t=e("#edit-document");if(!t.length){t=e("#localize-document")}if(t.is(".locked")){var n=t.find("input:enabled, textarea:enabled").prop("disabled",true)}e("#unlock-button").on("click",function(){n.prop("disabled",false);t.removeClass("locked");e("#locked-warning").slideUp(500);var i=t.data("slug");var a=window.location.toString();a=a.replace(/edit/,"steal_lock");e.ajax({url:a})})}function x(){var t=e("#content-diff");var n=e("#content-or-diff");if(t.length>0){n.append(t.clone()).append(e("<a/>").text(gettext("Toggle Diff")).click(function(e){e.preventDefault();n.toggleClass("content diff")}))}}function T(){var t=e("#revision-list form.filter");if(!t.length)return;function n(n){if(n===undefined){n=t.serialize()}if(n.charAt(0)!=="?"){n="?"+n}var i=t.attr("action")+n;var a=Math.min(e(document).scrollTop(),e("#revision-list").offset().top);e(document).scrollTop(a);history.replaceState({},"",i);e("#revisions-fragment").css("opacity",0);e.get(i+"&fragment=1",function(t){e(".loading").hide();e("#revisions-fragment").html(t).css("opacity",1)})}var i;t.on("change keyup","input, select",function(){e(".loading").show();clearTimeout(i);i=setTimeout(n,200)});e("#revision-list").on("click",".pagination a",function(){var t=e(this)[0].search;n(t);return false});e("#revision-list").on("click",".show-diff",function(){var t=e(this);t.hide();t.parent().find(".loading").show();var n=e('<div class="diff-view">').hide().appendTo(e(this).parents("li").first());var i=t.attr("href");e.get(i,function(e){n.html(e);n.find(".picker").html('<a href="" class="close-diff">Close diff</a>');n.slideDown();t.parent().find(".close-diff").show();t.parent().find(".loading").hide();k.initDiff()});return false});e("#revision-list").on("click",".close-diff",function(){var t=e(this).parents("li").first();t.find(".diff-view").slideUp(400,function(){t.find(".show-diff").show();t.find(".close-diff").hide();t.find(".diff-view").remove()});return false});t.find(".btn").remove();t.on("keydown",function(e){if(e.which===13){return false}});t.find("input[type=date]").datepicker()}e(document).ready(t);window.k.makeWikiCollapsable=function(){e("#toc").hide();e("#doc-content h1").each(function(){var t=e(this);var n=e(this).nextAll();var i=[];n.each(function(){if(e(this).is("h1")){return false}i.push(this)});var a=e("<div />");a.addClass("wiki-section").addClass("collapsed");t.before(a);a.append(t);var r=e("<section />");a.append(r);for(var s=0;s<i.length;s++){r.append(i[s])}});e("#doc-content").on("click","h1",function(){e(this).closest(".wiki-section").toggleClass("collapsed")})};if(e("#doc-content").is(".collapsible")){k.makeWikiCollapsable()}function S(){e("#support-for-exit").live("click",function(){e("#support-for").remove()})}})(jQuery);(function(e){function t(){n();o();i();a()}function n(){e("div.tags[data-tag-vocab-json]").each(function(){var t=e(this);var n=t.data("tag-vocab-json");t.data("tagVocab",_.keys(n))})}function i(){function t(t){var n=t.find("input.adder"),i=t.find("input.autocomplete-tags"),a=i.closest("div.tags"),r=a.data("can-create-tags")!==undefined,s=a.data("tagVocab"),o=l(i);
function c(){var t=e.trim(i.val()),a=f(t,s)!=-1,l=p(t,o);n.attr("disabled",!t.length||l||!r&&!a)}return c}function n(t){var n=t.data("tagVocab"),i=t.find("ul.tag-list");function a(t,a){var r=u(i),s=e.grep(n,function(t,n){return e.inArray(t,r)==-1});a(d(s,t.term))}return a}e("input.autocomplete-tags").each(function(){var i=e(this),a=t(i.closest("form"));i.autocomplete({source:n(i.closest("div.tags")),delay:0,minLength:1,close:a});i.keyup(a);i.bind("autocompletechange",a)})}function a(){e("div.tags").each(function(){var t=e(this),n=!t.hasClass("deferred");t.find(".tag").each(function(){r(e(this),n)})});e("form.remove-tag-form").submit(function(){return false})}function r(t,n){t.find(".remover").click(function(){var t=e(this),i=t.closest(".tag"),a=i.find(".tag-name").text(),r=t.closest("form").find("input[name=csrfmiddlewaretoken]").val();function s(){i.remove()}if(n){i.addClass("in-progress");e.ajax({type:"POST",url:t.closest("form.remove-tag-form").data("action-async"),data:{name:a,csrfmiddlewaretoken:r},success:s,error:function o(){i.removeClass("in-progress")}})}else s();return false})}function s(t,n){var i=t.find("input.autocomplete-tags"),a=i.val(),s=i.closest("div.tags").data("tagVocab"),o=f(a,s),c=t.find("input[name=csrfmiddlewaretoken]").val(),d;function u(t){var a=l(i);if(!p(t,a)){var s=e("<li class='tag'><span class='tag-name' /><input type='submit' value='&#x2716;' class='remover' /></li> ");if(n)s.addClass("in-progress");else{var o=e("<input type='hidden' />");o.attr("value",t);o.attr("name",i.attr("name"));s.prepend(o);r(s,false)}s.find(".tag-name").text(t);s.find("input.remover").attr("name","remove-tag-"+t);a.append(s);return s}}if(o==-1){if(n)s.push(a)}else a=s[o];d=u(a);if(d&&n){e.ajax({type:"POST",url:t.data("action-async"),data:{"tag-name":a,csrfmiddlewaretoken:c},success:function h(t){var n=t.tagUrl,i=d.find(".tag-name");i.replaceWith(e("<a class='tag-name' />").attr("href",n).text(i.text()));d.removeClass("in-progress");r(d,true)},error:function v(e){d.remove()}})}i.val("");t.find("input.adder").attr("disabled",true);return false}function o(){e("div.tags input.adder:enabled").attr("disabled",true);e(".tag-adder").each(function(){var t=e(this),n=!t.hasClass("deferred");function i(){return s(t,n)}if(t.is("form")){t.submit(i)}else{t.find("input.adder").click(i)}})}function l(e){return e.closest("div.tags").find("ul.tag-list")}function c(e){return e.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")}function d(t,n){var i=new RegExp(c(n),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)})}function f(e,t){var n=new RegExp("^"+c(e)+"$","i");for(var i=0;i<t.length;i++)if(n.test(t[i]))return i;return-1}function u(t){var n=[];t.find(".tag .tag-name").each(function(t,i){n.push(e(i).text())});return n}function p(e,t){return f(e,u(t))!=-1}e(document).ready(t)})(jQuery);(function(e){function t(){n();i();a();r();s()}function n(){e(".readout-modes").each(function t(){var t=e(this),n=t.attr("data-slug");t.find(".mode").each(function(){var i=e(this);i.click(function a(){var a=e("#"+n+"-table");a.addClass("busy");t.find(".mode").removeClass("active");i.addClass("active");e.get(i.attr("data-url"),function r(e){a.html(e).removeClass("busy")});return false})})})}function i(){var t=e("#doc-watch"),n=t.find(".popup-menu");t.find(".popup-trigger").click(function i(){n.toggle()});t.find("input[type=checkbox]").click(function a(){var t=e(this),n=t.closest("form").find("input[name=csrfmiddlewaretoken]").val(),i=t.attr("checked");t.attr("disabled","disabled");e.ajax({type:"POST",url:i?t.data("action-watch"):t.data("action-unwatch"),data:{csrfmiddlewaretoken:n},success:function(){t.attr("disabled","")},error:function(){t.attr("checked",i?"":"checked").attr("disabled","")}})})}function a(){e("#need-changes-table tr").click(function(t){if(!e(t.target).is("a")){e(this).toggleClass("active")}})}function r(){var t=e("#create-announcement form");t.find("button.btn-submit").on("click",function(n){n.preventDefault();var i=e("#create-announcement .kbox");t.addClass("wait");t.find(".error").remove();e.ajax({type:"POST",url:t.prop("action"),data:t.serialize(),statusCode:{200:function(n){t.removeClass("wait");i.hide(200,function(){i.data("kbox").close();i.show()});var a=e("#create-announcement").children(".success").show().css({opacity:1});setTimeout(function(){a.animate({opacity:0},1e3)},4e3)},400:function(e){var n,i;t.removeClass("wait");try{n=JSON.parse(e.responseText)}catch(a){n={}}for(i in n){t.find("[name="+i+"]").parent().after('<li class="error">'+n[i]+"</li>")}}}})});e(".announcements li a.delete").on("click",function(t){t.preventDefault();var n=e(this);e.ajax({type:"POST",url:n.prop("href"),data:{csrfmiddlewaretoken:e("input[name=csrfmiddlewaretoken]").val()},success:function(){n.closest("li").remove()}})})}function s(){var t=e("tr.ui-strings-row");var n=t.find("td");var i=new Date;var a=i.getYear().toString()+i.getMonth().toString()+i.getDay().toString();if(t.length===0){return}e.getJSON("/media/uploads/l10n_summary.json?_cache="+a,function(t){var i=t["locales"][e("html").attr("lang")];var a="bad";e(n[1]).html(interpolate(gettext("%(num)s <small>of %(total)s</small>"),{num:i.translated,total:i.total},true));if(i.percent>=20){a="better"}if(i.percent===100){a="best"}e(n[2]).html(interpolate("%(percent)s% "+'<div class="percent-graph">'+'<div style="width: %(percent)%" class="%(className)s">'+"</div>"+"</div>",{percent:i.percent,className:a},true))})}e(document).ready(t)})(jQuery);(function(e){"use strict";function t(){e(".editable a.edit").each(function(){var t=e(this),n=t.text();t.click(function(e){var i=t.closest(".editable");i.toggleClass("edit-on");if(i.hasClass("edit-on")){t.text(gettext("Cancel"))}else{t.text(n)}e.preventDefault()})})}e(document).ready(t)})(jQuery);(function(e){function t(){if(!e("body").is(".document")){return}e(document).on("vote",function(e,i){var a;if(_gaq){if("helpful"in i){a="Helpful"}else if("not-helpful"in i){a="Not Helpful"}else{return}_gaq.push(["_trackEvent","Article Vote",i.source+" - "+a,n()+" / "+t()])}});e("#os").change(function(){if(_gaq){_gaq.push(["_trackEvent","ShowFor Switch","OS - "+e(this).val(),n()+" / "+t()])}});e("#browser").change(function(){if(_gaq){_gaq.push(["_trackEvent","ShowFor Switch","Version - "+e(this).val(),n()+" / "+t()])}});setTimeout(function(){if(_gaq){_gaq.push(["_trackEvent","Article Read",n()+" / "+t()])}},1e4);function t(){return e("html").attr("lang")}function n(){return e("body").data("default-slug")}}e(document).ready(t)})(jQuery);