<!doctype html><html lang="en">
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>WMIC - Windows Management | Windows CMD | SS64.com</title>

<style type="text/css">
.prompt {color: #993300}
</style></head><body><!-- #BeginLibraryItem "/Library/head_nt.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="http://ss64.com/"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="http://ss64.com/nt">CMD</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="http://www.google.com/search" method="get">
<button tabindex="-1" type="submit" id="q-img"></button>
<input type="text" name="q" id="q" size="27" maxlength="255" onblur="if(this.value=='')this.value='Search…';" onclick="if(this.value=='Search…')this.value='';" value="Search…">
<input type="hidden" name="sitesearch" value="ss64.com/nt/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>WMIC.exe</h1> 
<p> Windows Management Instrumentation Command. <br>
Read a huge range of information about local or remote computers. Also provides a way to make configuration changes to multiple remote machines. WMIC is available on Vista/Windows 7, Windows XP Professional, but not Windows XP Home.</p>
<pre>Syntax
   Retrieve information about <i>&lt;Alias&gt;</i>:
      WMIC [<a href="wmicglobal.html"><i>global_switches</i></a>] [/locale:ms_409] &lt;<i>alias</i>&gt; [<i><a href="wmic.html#alias_options">options</a></i>] [<a href="wmic.html#format_specifiers">format</a>]

   Interactive mode:
      WMIC

Aliases:
 ALIAS               - Access local system aliases [CALL]

 BASEBOARD           - Base board management (motherboard or system board) 
 BIOS                - BIOS management (Basic input/output services) 
 BOOTCONFIG          - Boot configuration

 CDROM               - CD-ROM
 COMPUTERSYSTEM      - Computer system [CALL/SET]
 CPU                 - CPU
 CSPRODUCT           - Computer system product information from SMBIOS. 

 DATAFILE            - DataFiles [CALL]
 DCOMAPP             - DCOM Applications.
 DESKTOP             - User's Desktop
 DESKTOPMONITOR      - Desktop Monitor
 DEVICEMEMORYADDRESS - Device memory addresses
 DISKDRIVE           - Physical disk drive
 DISKQUOTA           - Disk space usage for NTFS volumes.[SET]
 DMACHANNEL          - Direct memory access (DMA) channel

 ENVIRONMENT         - System environment settings [SET]
 FSDIR               - Filesystem directory entry [CALL]

 GROUP               - Group account [CALL]

 IDECONTROLLER       - IDE Controller
 IRQ                 - Interrupt request line

 JOB                 - Jobs scheduled using the schedule service.[CALL]

 LOADORDER           - System services that define execution dependencies. 
 LOGICALDISK         - Local storage devices [CALL/SET]
 LOGON               - LOGON Sessions.

 MEMCACHE            - Cache memory
 MEMLOGICAL          - System memory, layout and availability
 MEMPHYSICAL         - Physical memory management

 NETCLIENT           - Network Client management.
 NETLOGIN            - Network login information for a particular user. 
 NETPROTOCOL         - Protocols (and their network characteristics).
 NETUSE              - Active network connection.
 NIC                 - Network Interface Controller (NIC)
 NICCONFIG           - Network adapter. [CALL] 
 NTDOMAIN            - NT Domain. [SET]  
 NTEVENT             - NT Event Log.  
 NTEVENTLOG          - NT eventlog file [CALL/SET]

 ONBOARDDEVICE       - Common adapter devices built into the motherboard.
 OS                  - Operating System/s [CALL/SET]

 PAGEFILE            - Virtual memory file swapping
 PAGEFILESET         - Page file settings [SET]
 PARTITION           - Partitioned areas of a physical disk.
 PORT                - I/O ports
 PORTCONNECTOR       - Physical connection ports
 PRINTER             - Printer device [CALL/SET]
 PRINTERCONFIG       - Printer device configuration  
 PRINTJOB            - Print job [CALL]
 PROCESS             - Processes [CALL]*
 PRODUCT             - Windows Installer [CALL]

 QFE                 - Quick Fix Engineering (patches)
 QUOTASETTING        - Setting information for disk quotas on a volume. [SET]

 REGISTRY            - Computer system registry [SET]

 SCSICONTROLLER      - SCSI Controller [CALL]
 SERVER              - Server information 
 SERVICE             - Service application [CALL]
 SHARE               - Shared resourcees [CALL]
 SOFTWAREELEMENT     - Elements of a software product*
 SOFTWAREFEATURE     - Subsets of SoftwareElement. [CALL]*
 SOUNDDEV            - Sound Devices 
 STARTUP             - Commands that run automatically when users logon
 SYSACCOUNT          - System account  
 SYSDRIVER           - System driver for a base service. [CALL]
 SYSTEMENCLOSURE     - Physical system enclosure
 SYSTEMSLOT          - Physical connection points including ports,
                       slots and peripherals, and proprietary connections points.

 TAPEDRIVE           - Tape drives  
 TEMPERATURE         - Temperature sensor (electronic thermometer).
 TIMEZONE            - Time zone data 

 UPS                 - Uninterruptible power supply (UPS) 
 USERACCOUNT         - User accounts [CALL/SET]

 VOLTAGE             - Voltage sensor (electronic voltmeter) data
 VOLUME              - Local storage volume [CALL/SET]
 VOLUMEQUOTASETTING  - Associates the disk quota setting with a specific disk volume. [SET]

 WMISET              - WMI service operational parameters [SET]

New aliases in Windows 2003: 
 MEMORYCHIP          - Memory chip information.
 RDACCOUNT           - Remote Desktop connection permission [CALL]
 RDNIC               - Remote Desktop connection on a specific network adapter [CALL/SET]
 RDPERMISSIONS       - Permissions to a specific Remote Desktop connection [CALL]
 RDTOGGLE            - Turn Remote Desktop listener on or off remotely[CALL]
 RECOVEROS           - Blue Screen Information [SET]
 SHADOWCOPY          - Shadow copy management [CALL]
 SHADOWSTORAGE       - Shadow copy storage areas [CALL/SET]
 VOLUMEUSERQUOTA     - Per user storage volume quotas  [SET]
</pre>
<p><b>Options<a id="alias_options"></a></b>  </p>
<p> By default an alias will return a standard LIST of information, you can also choose to GET one or more specific properties.</p>
<p>Configuration changes can be made, where indicated above with: [CALL or SET ]</p>
<p>The CREATE and DELETE options allow you to change the WMI schema itself.</p>
<pre>
   <i>alias</i> 
   <i>alias</i> <u>LIST</u> [BRIEF | <u>FULL</u> | INSTANCE | STATUS |SYSTEM | WRITEABLE]
                [/TRANSLATE:BasicXml<i>|</i>NoComma ]
                   [/EVERY:<i>no_secs</i>] [/FORMAT:<i>format</i>]
   <i>alias</i> GET [<i>property list</i>]
                [/VALUE ] [/<u>ALL</u> ] [/TRANSLATE:BasicXml<i>|</i>NoComma<i> </i>]
                   [/EVERY:<i>no_secs</i>] [/FORMAT:<i>format</i>]
   <i>alias</i> CALL <i>method_name</i> [<i>parameters</i>]
   <i>alias</i> SET [<i>assignments</i>]
   <i>alias</i> CREATE 
   <i>alias</i> DELETE
   <i>alias</i> ASSOC [/RESULTCLASS:<i>classname</i>] [/RESULTROLE:<i>rolename</i>][/ASSOCCLASS:<i>assocclass</i>]

For more help<i>
</i>   WMIC <a href="wmicglobal.html">/locale</a>:ms_409 /<i>alias</i> /?<i>
</i>   WMIC <a href="wmicglobal.html">/locale</a>:ms_409 /<i>alias option</i> /?
   e.g.
   WMIC <a href="wmicglobal.html">/locale</a>:ms_409 /BIOS /CALL /?
   WMIC <a href="wmicglobal.html">/locale</a>:ms_409 /MEMLOGICAL /SET /?</pre>
<p><span class="body">The order of the /FORMAT and /TRANSLATE switches is significant: if /TRANSLATE follows /FORMAT, the output is formatted first and then translated. </span></p>
<p><span class="body">All the options above can  be extended with a WHERE clause, best shown by the examples below:</span></p>
<pre><b>Format</b><a id="format_specifiers"></a>:</pre>
<p>Format defines the layout of the information, XML output is automatically formatted using a default style sheet, while other formats (HTML, Table, MOF, Raw XML etc) can be  specified  using <span class="code"><a href="wmicstylesheets.html">/FORMAT: <i>stylesheet_name</i></a></span></p>
<p>Stylesheets supplied with WMIC: </p>
<pre>    csv.xsl, hform.xsl, htable-sortby.xsl, htable.xsl<br>    texttable.xsl, textvaluelist.xsl, xml.xsl
</pre>
<p>All output files are unicode text (convert to ASCII with <a href="type.html">TYPE</a>)  
Tab Separated Values (.tsv) can be opened in excel </p>
<p>  The PROCESS alias can be used to start a new installation process, if doing this across the network, place the installer files on a share with permissions EVERYONE : Read Only. This is because network credentials will be dropped when jumping from one remote machine to another (unless you have kerberos configured).</p>
<p><b>Examples</b></p>
<pre>WMIC <a href="wmicglobal.html">/locale</a>:ms_409 <b>OS</b> 

WMIC <b>OS</b> LIST BRIEF

WMIC <b>OS</b> GET csname, locale, bootdevice

WMIC <b>OS</b> GET osarchitecture /value

WMIC <b>OS</b> GET localdatetime

WMIC <a href="wmicglobal.html">/locale</a>:ms_409 <b>NTEVENT</b> where LogFile='system'

WMIC <b>NTEVENT</b> where &quot;LogFile='system' and Type&gt;'0'&quot; 

WMIC <b>SERVICE</b> where (state=&#8221;running&#8221;) GET caption, name, state &gt; services.tsv

WMIC <b>SERVICE</b> where caption='TELNET' CALL STARTSERVICE

WMIC <b>PRINTER</b> LIST STATUS

WMIC <b>PRINTER</b> where PortName=&quot;LPT1:&quot; GET PortName, Name, ShareName
 
WMIC <a href="wmicglobal.html">/INTERACTIVE</a>:ON <b>PRINTER</b> where PortName=&quot;LPT1:&quot; DELETE

WMIC <b>PROCESS</b> where name='evil.exe' delete

WMIC <a href="wmicglobal.html">/output</a>:&quot;%computername%.txt&quot; <b>MEMORYCHIP</b> where &quot;memorytype=17&quot; get Capacity

WMIC <a href="wmicglobal.html">/node</a>:remote_computer <b>PROCESS</b> call create <b>&quot;</b>netstat.exe -ano &gt; C:\output.txt<b>&quot;</b>

WMIC <a href="wmicglobal.html">/node</a>:@workstns.txt <a href="wmicglobal.html">/failfast</a>:on <b>PROCESS</b> call create <b>&quot;</b>\\server\share\installer.cmd<b>&quot;</b>

Interactive mode:
<span class="prompt">C:&gt;</span> START &quot;Windows Management&quot; WMIC
<span class="prompt">wmic:root\cli&gt; </span>/locale:ms_409
<span class="prompt">wmic:root\cli&gt;</span><b> OS</b> get csname
<span class="prompt">wmic:root\cli&gt; </span>quit</pre>
<p><b>Notes</b></p>
<p>WMIC is available on  XP Professional and Windows
2003 or later versions of Windows.</p>
<p>The availability of  WMI information does vary across different versions of Windows<br>
e.g. ODBC, SNMP, Windows Installer.</p>
<p>To run WMIC requires administrator rights.</p>
<p>The last element returned by WMIC is  a single  <span class="code">&lt;CR&gt;</span> character (an empty line), when running WMIC in a FOR loop you may need to <a href="http://stackoverflow.com/questions/8015489/why-is-the-for-f-loop-in-this-batch-script-evaluating-a-blank-line">remove</a> this, particularly if  <a href="delayedexpansion.html">delayed expansion</a> is involved.</p>
<p>In Windows 2000, around 4,000 properties can be monitored, and around 40 can be configured.<br>
In Windows XP around 6,000 properties  can be monitored, and around 140 can be configured.</p>
<p>Windows 2003 offers a few improvements and bug fixes: the global option <b>/locale:ms_409</b> is not required (it defaults to English US.) </p>
<p>When you type WMIC for the first time in Windows 2003 all the aliases are compiled. The second, and subsequent times you run WMIC, it will start  immediately. Under  XP WMIC is slower to initialise,  therefore to run several
WMI queries it can be quicker to use interactive mode.</p>
<p>Running WMIC within a batch file it may sometimes hang, possible workarounds for this:<br>
<span class="code">START &quot;&quot; /W CMD /C WMIC <i>options</i>...<br>
WMIC <i>options</i>... &lt;NUL</span></p>
<p> * WMI information  for installed software packages (PACKAGE and SOFTWAREFEATURE) is often incomplete  and inconsistent for a variety of historical reasons. A more reliable method is to retrieve a list of installed programs directly
from the Add/Remove list in the registry, with a WSH script like <a href="installed.txt">this</a> from Torgeir Bakken.<br>
<br>
<i class="quote">&ldquo;Life is like a game of cards. The hand you are dealt is determinism; the way you play it is free will&rdquo; ~ Jawaharial Nehru</i><br>
<br>
<b>Related:</b><br>
<br>
<a href="systeminfo.html">SYSTEMINFO</a> - List system configuration<br>
<a href="http://isc.sans.edu/diary.html?storyid=2376">The Grammar of WMIC</a> - ISC<br>
<a href="http://www.microsoft.com/en-us/download/details.aspx?id=7684">WMI Diagnosis Utility</a> - Microsoft<br>
<a href="http://ss64.com/ps/get-wmiobject.html">Get-WMIobject</a> - Get WMI class information (Powershell)<br>
MOF (Managed Object Format) - A language that describes management information.<br>
<a href="http://support.microsoft.com/?kbid=824223">Q824223</a> - WMIC command runs slowly with /FAILFAST switch.<br>
<a href="http://support.microsoft.com/?kbid=875605">Q875605 </a>- Troubleshoot WMI-related issues<br>
<a href="http://support.microsoft.com/servicedesks/webcasts/wc072402/listofsampleusage.asp">Sample commands</a> - Windows 2003<br>
<a href="http://msdn.microsoft.com/en-us/library/Aa394572">MSDN full WMI reference</a> - Classes, providers etc</p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p><script type="text/javascript"><!--
google_ad_client = "pub-6140977852749469";
google_alternate_color = "CCCCCC";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "text_image";
google_ad_channel ="0282121944";
google_color_border = "CCCCCC";
google_color_bg = "CCCCCC";
google_color_link = "000000";
google_color_text = "333333";
google_color_url = "0000FF";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
<hr>
<div id=bl class="footer"><a href="wmic.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id=br class="footer, tagline">&copy; Copyright <a href="http://ss64.com/">SS64.com</a> 1999-2015<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
