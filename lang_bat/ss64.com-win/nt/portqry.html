<!doctype html><html lang="en">
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>portqry | Windows CMD | SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_nt.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="http://ss64.com/"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="http://ss64.com/nt">CMD</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="http://www.google.com/search" method="get">
<button tabindex="-1" type="submit" id="q-img"></button>
<input type="text" name="q" id="q" size="27" maxlength="255" onblur="if(this.value=='')this.value='Search…';" onclick="if(this.value=='Search…')this.value='';" value="Search…">
<input type="hidden" name="sitesearch" value="ss64.com/nt/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>PORTQRY (<a href="http://www.microsoft.com/downloads/details.aspx?familyid=89811747-C74B-4638-A2D5-AC828BDC6983&displaylang=en">Download</a>)</h1>
<p>Port Query - Display the status of TCP and UDP ports, troubleshoot TCP/IP  connectivity and security, return LDAP base query info, SMTP, POP3, IMAP4 status, enumerate SQL Server instances (UDP port 1434), Local  ports, local services running
 (and the DLL modules loaded by each).</p>
<p>Portqry.exe can query a single port, a list of several ports, or a sequential range of port numbers.</p>
<pre>Syntax

The 3 modes are listed below: Command line, Local and Interactive mode.

<b>Command line mode:</b>
   portqry -n <i>name_to_query</i> [-p <i>protocol</i>]
             [-e | -r | -o <i>endpoint(s</i>)]
                [<i>other options</i>]

Command line mode options:
   -n [<i>name_to_query</i>]   IP address or name of system to query
   -p [<i>protocol</i>]        TCP or UDP or BOTH (default is TCP)

   -e [<i>endpoint</i>]        Single Port to query (valid range: 1-65535)
   -r [<i>end point range</i>] Range of ports to query (start:end)
   -o [<i>end point order</i>] Range of ports to query in an order (x,y,z)

   -l [<i>logfile</i>]  Output a log file
   -y            Overwrite existing log file without prompting
   -sp [<i>source port</i>] Initial source port to use for query
   -sl    'slow link delay' Wait longer for UDP replies from remote systems
   -nr     By-pass default IP address-to-name resolution
           ignored unless an IP address is specified after -n
   -cn     Specify SNMP community name for query
           ignored unless querying an SNMP port
           must be delimited with !
   -q      'Quiet' operation runs with no output
           returns 0 if port is listening 		
           returns 1 if port is not listening
           returns 2 if port is listening or filtered

<b>Local Mode:</b>
Local Mode gives detailed data on local system's ports

   portqry -local [-wt <i>seconds</i>] [-l <i>logfile</i>] [-v]
   portqry -wpid pid [-wt <i>seconds</i>] [-l <i>logfile</i>] [-v]
   portqry -wport port [-wt <i>seconds</i>] [-l <i>logfile</i>] [-v]

Local mode options:
   -local   Enumerate local port usage, port to process mapping,
	         service port usage, and list loaded modules

   -wport [<i>port_number</i>]  Watch the specified port
	         report when the port's connection status changes

   -wpid [<i>process_ID</i>]    Watch the specified process ID (PID)
           report when the PID's connection status changes
   -wt [<i>seconds</i>]   Watch time option
           specify how often to check for status changes
           valid range: 1 - 1200 seconds (default = 60 secs)

   -l [<i>logfile</i>]  Log file to create
	
   -v            Verbose output

<b>Interactive Mode:</b>
An alternative to command line mode

portqry -i [-<i>options</i>]

For help with -i run portqry.exe and then type 'help' &lt;enter&gt;
</pre>
<p><b>Examples</b></p>
<pre>
portqry -local
portqry -local -l MyLogFile.txt -v
portqry -wpid 1272 -wt 5 -l MyLogFile.txt -y -v
portqry -wport 53 -l dnslog.txt
portqry -n myserver.com -e 25
portqry -n 10.0.0.1 -e 53 -p UDP -i
portqry -n host1.dev.reskit.com -r 21:445
portqry -n 10.0.0.1 -o 25,445,1024 -p both -sp 53
portqry -n host2 -cn !my community name! -e 161 -p udp</pre>
<p><span class="body"><b>Notes</b></span></p>
<p>PortQry runs on Windows 2000 and later systems For best results run local commands in the context of local administrator.<br>
Port to process mapping may not be available on all systems.<br>
Defaults: TCP, port 80, no log file, slow link delay off<br>
Hit Ctrl-C to terminate prematurely<i>.</i></p>
<p><i class="quote">&ldquo;I always look for a woman who has a tattoo. I see a woman with a tattoo, and I’m thinking, okay, here’s a gal who’s capable of making a decision she’ll regret in the future&rdquo; - Richard Jeni</i><br>
<br>
<b>Related:</b><br>
<a href="nslookup.html"><br>
nslookup</a> - Lookup IP addresses on a NameServer<br>
<a href="http://www.microsoft.com/downloads/details.aspx?familyid=69BA779B-BAE9-4243-B9D6-63E62B4BCD2E&displaylang=en">PortRptr</a> - Port Reporter, logging service for  TCP/IP port usage<br>
<a href="netsh.html">NETSH diag</a> - <span class="body">Connect to TCP port</span><br>
<a href="wmic.html">WMIC PORTCONNECTOR</a> - Access Physical port<br>
<a href="http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml">Port Numbers</a> at IANA or <a href="http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers">Wikipedia list of TCP and UDP port numbers</a><br>
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;310099">Q310099</a> - Description of PortQry<br>
<a href="http://support.microsoft.com/default.aspx?kbid=832919">Q832919</a> - PortQry Version2<br>
<a href="http://support.microsoft.com/default.aspx?kbid=310456">Q310456</a> -
Use PortQry to Troubleshoot Active Directory Connectivity <br>
<a href="http://support.microsoft.com/default.aspx?kbid=310298">Q310298</a> -
Use PortQry to Troubleshoot MS Exchange</p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p><script type="text/javascript"><!--
google_ad_client = "pub-6140977852749469";
google_alternate_color = "CCCCCC";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "text_image";
google_ad_channel ="0282121944";
google_color_border = "CCCCCC";
google_color_bg = "CCCCCC";
google_color_link = "000000";
google_color_text = "333333";
google_color_url = "0000FF";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
<hr>
<div id=bl class="footer"><a href="portqry.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id=br class="footer, tagline">&copy; Copyright <a href="http://ss64.com/">SS64.com</a> 1999-2015<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
