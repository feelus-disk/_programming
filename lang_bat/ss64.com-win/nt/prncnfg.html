<!doctype html><html lang="en">
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>prncnfg | Windows CMD | SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_nt.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="http://ss64.com/"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="http://ss64.com/nt">CMD</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="http://www.google.com/search" method="get">
<button tabindex="-1" type="submit" id="q-img"></button>
<input type="text" name="q" id="q" size="27" maxlength="255" onblur="if(this.value=='')this.value='Search…';" onclick="if(this.value=='Search…')this.value='';" value="Search…">
<input type="hidden" name="sitesearch" value="ss64.com/nt/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>PRNCNFG.vbs (Vista and above or <a href="http://ss64.com/links/windows.html">2003 adminpack.msi</a>)</h1>
<p>Configure a printer (set properties, rename).<br>
</p>
<p>Display configuration information about a printer:<br>
</p>
<pre>
    cscript prncnfg.vbs <b>-g</b> [-s <i>RemoteComputer</i>]
            -p <i>PrinterName</i> 
               [-u <i>UserName</i> -w <i>Password</i>] 

<span class="body">Configure a printer:</span>

    cscript prncnfg.vbs <b>-t</b> [-s <i>RemoteComputer</i>]
            -p PrinterName [-r <i>PortName</i>] [-l <i>Location</i>]
                [-m Comment] [-h <i>ShareName</i>] [-f <i>SeparatorText</i>]
                   [-y <i>DataType</i>] [-st <i>StartTime</i>] [-ut <i>EndTime</i>] [-o <i>Priority</i>]
                      [-i DefaultPriority] [{+ | -}shared] [{+ | -}direct]
                         [{+ | -}published] [{+ | -}hidden] [{+ | -}rawonly]
                              [{+ | -}queued] [{+ | -}keepprintedjobs]
                                  [{+ | -}workoffline] [{+ | -}enabledevq]
                                     [{+ | -}docompletefirst][{+ | -}enablebidi]

<span class="body">Change the name of a printer</span>:

    cscript prncnfg.vbs <b>-x</b> [-s <i>RemoteComputer</i>]
            -p <i>PrinterName</i> -z <i>NewPrinterName</i>
              [-u <i>UserName</i> -w <i>Password</i>] 

Key

   -s <i>RemoteComputer</i> 
         The name of the remote computer that manages the printer. 

   -p <i>PrinterName</i> 
         The name of the printer.

   -u <i>UserName</i> -w <i>Password</i> 
         An account with permission to connect WMI services to the computer
         that hosts the printer. e.g. A member of the Administrators group. 

   -r <i>PortName</i> 
         The port to which the printer is connected.
         If this is a parallel or a serial port, then use the ID of the port
         (for example, LPT1 or COM1). If this is a TCP/IP port, then use the
         port name that was specified when the port was added. 

   -l <i>Location</i> 
         The printer location, such as "Copier Room." 

   -m <i>Comment</i> 
         A comment string. 

   -h <i>ShareName</i> 
         The share name. 

   -f <i>SeparatorText</i> 
         A file that contains the text that appears on the separator page. 

   -y <i>DataType</i> 
         Data types that the printer can accept. 

   -st <i>StartTime</i> 
         Specify a time of the day after which the printer is available.
         If you send a document to a printer when it is unavailable, the
         document is held (spooled) until the printer becomes available.
         Specify time as a 24-hour clock. e.g. 2300

   -ut <i>EndTime</i> 
         Specify a time of the day after which the printer is no longer available.

   -o <i>Priority</i> 
         A priority that the spooler uses to route print jobs.
         A print queue with a higher priority receives all its
         jobs before any queue with a lower priority. 

   -i <i>DefaultPriority</i> 
            The default priority assigned to each print job. 

   {+ | -}shared 
            Is this printer is shared on the network. 

   {+ | -}direct 
            Is the document to be sent directly to the printer without being spooled. 

   {+ | -}published 
            Is this printer to be published in Active Directory.
            If you publish a printer, other users can search for it based on its location
            and capabilities, such as color printing and stapling.

   {+ | -}hidden 
             Reserved function.

   {+ | -}rawonly 
             Are only raw data print jobs to be spooled on this queue. 

   {+ | -}queued 
             Do not begin to print until after the last page of the document is spooled.
             The printing program is unavailable until the document has finished printing.
             This option ensures that the whole document is available to the printer.

   {+ | -}keepprintedjobs 
             Retain documents after they are printed.
             Allows a user to resubmit a document to the printer from the print queue. 

   {+ | -}workoffline 
             Allow sending print jobs when computer is not connected to the network. 

   {+ | -}enabledevq 
             Print jobs that do not match the printer setup (for example, PostScript files
             spooled to non-PostScript printers) should be held in the queue rather than 
             being printed. 

   {+ | -}docompletefirst 
             Allocate jobs to a printer as soon as thay are spooled.
             If this option is disabled, the spooler always sends higher priority
             jobs to their respective queues first.
             You should enable this option if you want to maximize printer efficiency
             at the cost of job priority.  

   {+ | -}enablebidi 
             Send bi-directional status information to the spooler.

   ?         Help</pre>
<p>Prncnfg.vbs may not be included in the Windows <a href="path.html">PATH</a> but will be found at <span class="code">%Windir%\System32\Printing_Admin_Scripts\en-US\prncnfg.vbs</span><br>
If installed via the 2003 adminpack, it will be located in the \Program files\Windows Resource Kits\ folder.</p>
<p>Examples</p>
<pre>   Set _scripts=cscript <span class="code">%Windir%\System32\Printing_Admin_Scripts\en-US</span>

   :: Rename printer
   %_scripts%\prncnfg.vbs -x -p OldPrinter45 -z NewPrinter64</pre>
<p class="quote"><i>“Without books the development of civilization would have been impossible. They are the engines of change, windows on the world, ''Lighthouses'' as the poet said ''erected in the sea of time'.' They are companions, teachers, magicians, bankers of the treasures of the mind, Books are humanity in print”  ~ Arthur Schopenhauer</i></p>
<p><b>Related:</b><br>
<br>
<a href="print.html">PRINT</a> - Print a text file<br>
<a href="net_share.html">NET VIEW</a> - to view a list of printers<br>
<a href="net_print.html">NET PRINT</a> - View and Delete print jobs <br>
PRNDRVR - Add, delete or list printer drivers.<br>
PRNJOBS - Pause, resume, cancel, or list print jobs<br>
<a href="prnmngr.html">PRNMNGR</a> - Add, delete, or list printers / connections, set the default printer. 
<br>
PRNPORT/PRNQCTL - Manage printer ports &amp; printer queues.<br>
<a href="rundll32.html">RUNDLL32</a> - Install/Remove Printers (plus advanced options)<br>
<a href="wmic.html">WMIC PRINTER</a> - Set printing options through WMI. <br>
<a href="http://support.microsoft.com/?kbid=246868">Q246868</a> - New TCP/IP Printing Options in the Windows Standard Port Monitor <br>
Add printer - <a href="http://ss64.com/vb/addprinter.html">.AddPrinterConnection</a> <br>
Add Network printer - <a href="http://ss64.com/vb/addwinprinter.html">.AddWindowsPrinterConnection</a> 
<br>
List printers - <a href="http://ss64.com/vb/enumprinter.html">.EnumPrinterConnections</a> 
<br>
Set default printer - <a href="http://ss64.com/vb/defaultprint.html">.SetDefaultPrinter</a><br>
Equivalent bash command (Linux): 
<a href="http://ss64.com/bash/lpc.html">lpc</a> - Line printer control program</p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p><script type="text/javascript"><!--
google_ad_client = "pub-6140977852749469";
google_alternate_color = "CCCCCC";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "text_image";
google_ad_channel ="0282121944";
google_color_border = "CCCCCC";
google_color_bg = "CCCCCC";
google_color_link = "000000";
google_color_text = "333333";
google_color_url = "0000FF";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
<hr>
<div id=bl class="footer"><a href="prncnfg.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id=br class="footer, tagline">&copy; Copyright <a href="http://ss64.com/">SS64.com</a> 1999-2015<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
