<!doctype html><html>
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>New-ADObject | PowerShell | SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="http://ss64.com/"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="http://ss64.com/ps">PowerShell</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="http://www.google.com/search" method="get">
<button tabindex="-1" type="submit" id="q-img"></button>
<input type="text" name="q" id="q" size="27" maxlength="255" onblur="if(this.value=='')this.value='Search…';" onclick="if(this.value=='Search…')this.value='';" value="Search…">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>New-ADObject</h1> 
<p>Create an AD object.</p>
<pre>Syntax
      New-ADObject [-Name] <i>string</i> [-Type] <i>string</i>
         [-AuthType {<u>Negotiate</u> | Basic}] [-Credential <i>PSCredential</i>]
            [-Description <i>string</i>] [-DisplayName <i>string</i>]
               [-Instance <i>ADObject</i>] [-OtherAttributes <i>hashtable</i>]
                  [-PassThru] [-Path <i>string</i>] [-ProtectedFromAccidentalDeletion <i>bool</i>]
                     [-Server <i>string</i>] [-Confirm] [-WhatIf] [<i>CommonParameters</i>]

Key
   -AuthType {<u>Negotiate</u> | Basic}
       The authentication method to use: Negotiate (or 0), Basic (or 1)
       A Secure Sockets Layer (SSL) connection is required for Basic authentication.

   -Credential <i>PSCredential</i>
       The user account credentials to use to perform this task.
       The default credentials are those of the currently logged on user unless the
       cmdlet is run from an Active Directory PowerShell provider drive.
       If the cmdlet is run from such a provider drive, the account associated with the drive is the default.

       Type a user name, such as "User64" or "Domain64\User64" or specify a
       PSCredential object such as one generated by <a href="get-credential.html">Get-Credential</a> 

       If a user name is specified, the cmdlet will prompt for a password.

   -Description <i>string</i>
       A description of the object.

   -DisplayName <i>string</i>
       The display name of the object.

   -Instance <i>ADObject</i>
       An instance of an object to use as a template for a new AD object.

       Use an instance of an existing AD object as a template or construct a
       new group object by using the PowerShell command line or by using a script.

       The following examples show how to use these two methods:

       Method 1: Use the Get-ADObject cmdlet and then override property values of
       the new object by setting the appropriate parameters. 

          $ObjectInstance = Get-ADObject -Identity "Desktop001" 
          New-ADObject -Name "Desktop002" -Instance $ObjectInstance -Type &quot;computer&quot;

       Method 2: Use the New-Object cmdlet and pass the object to the New-ADObject cmdlet.

          $objectInstance = New-Object Microsoft.ActiveDirectory.Management.ADObject
          $objectInstance.Description = &quot;Desktop002 Computer&quot;
          New-ADObject -Name Desktop002  -Instance $ObjectInstance -Type computer

       Note: Specified attributes are not validated, so attempting to set attributes that
             do not exist or cannot be set will raise an error.

   -Name <i>string</i>
       The name of the object.

   -OtherAttributes <i>hashtable</i>
       Object attribute values for attributes that are not represented by cmdlet parameters.
       Set one or more parameters at the same time with this parameter.
       If an attribute takes more than one value, you can assign multiple values.
       To identify an attribute, specify the LDAPDisplayName (ldapDisplayName) defined for it in
       the Active Directory schema.

        Syntax:
        To specify a single value for an attribute:
           -OtherAttributes @{'AttributeLDAPDisplayName'=value}
        To specify multiple values for an attribute
           -OtherAttributes @{'AttributeLDAPDisplayName'=value1,value2,...}

        Specify values for more than one attribute by using semicolons to separate attributes.
        To set values for multiple attributes:
           -OtherAttributes @{'Attribute1LDAPDisplayName'=value; 'Attribute2LDAPDisplayName'=value1,value2;...}

        The following examples show how to use this parameter.

        To set the value of a custom attribute called favColors that takes a set of Unicode strings: 
           -OtherAttributes @{'favColors'="pink","purple"}

        To set values for favColors and dateOfBirth simultaneously, use the following syntax:
           -OtherAttributes @{'favColors'="pink","purple"; 'dateOfBirth'=" 01/01/1960"}

   -PassThru <i>switch</i>
       Return the new or modified object.
       By default (i.e. if -PassThru is not specified), this cmdlet does not generate any output.
        
   -Path <i>string</i>
       The X.500 path of the Organizational Unit (OU) or container where the new object is created.  

       In many cases, a <a href="path-defaults.html">default value</a> will be used for -Path if no value is specified.

       Note:  The PowerShell cmdlets, such New-Item, Remove-Item, Remove-ItemProperty, Rename-Item and 
       Set-ItemProperty also contain a Path property. However, for the <a href="ad.html">AD provider cmdlets</a>, the -Path parameter 
       identifies the path of the actual object and not the container.

   -ProtectedFromAccidentalDeletion <i>bool</i>
       When this property is true, you cannot delete the corresponding object without
       first resetting the value of this property.
       Values: $true (or 1), $false (or 0)<br>          <br>          
   -Server <i>string</i>
       The AD Domain Services instance to connect to, this may be a Fully qualified domain name,
       NetBIOS name, Fully qualified directory server name (with or without port number)

   -Type <i>string
</i>       The type of object to create.
       Set the Type parameter to the LDAP display name of the AD Schema Class that represents
       the type of object to be created. Examples: -type user, -type computer, -type group.

   -Confirm
       Prompt for confirmation before executing the command.

   -WhatIf
       Describe what would happen if you executed the command without actually executing the command.

   <a href="common.html">CommonParameters</a>:
       -Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,
       -OutBuffer -OutVariable.</pre>
<p>New-ADObject  creates a new AD object such as a new organizational unit or new user account. Use this cmdlet to create any type of AD object. Many object properties are defined by setting cmdlet parameters. Properties that are not set by cmdlet parameters can be set by using the -OtherAttributes parameter. </p>
<p>The <span class="code">-Name</span> and <span class="code">-Type</span> parameters are required to create a new AD object. The Name specifies the name of the new object. The Type parameter specifies the LDAP display name of the Active Directory Schema Class that represents the type of object you want to create. Examples of -Type values include computer, group, organizational unit, and user.<br>
The <span class="code">-Path</span> parameter specifies the container where the object will be created.<br>
<br>
There are 3 different ways to create an object  using New-ADObject:</p>
<p>Method 1: Use  New-ADObject, specifing the required parameters.</p>
<p>Method 2: Use a template to create the new object. Create or retrieve a copy of an existing AD object and set the <span class="code">-Instance</span> parameter to this object. The object provided to the <span class="code">-Instance</span> parameter is used as a template for the new object.</p>
<p>Method 3: Use  <a href="import-csv.html">Import-CSV</a> with the New-ADObject cmdlet to create multiple AD objects. Use  <a href="import-csv.html">Import-CSV</a> to create  custom objects from a CSV file that contains a list of object properties. Then pass the objects through the <a href="syntax-pipeline.html">pipeline</a> to New-ADObject.</p>
<p><b>Examples</b></p>
<p>Creates a subnet object in the Aberdeen site with the described attributes:</p>
<p><span class="code">PS C:\&gt; New-ADObject -Name '192.168.1.0/26' -Type subnet -Description '192.168.1.0/255.255.255.192' -OtherAttributes @{location=&quot;West Tullos&quot;;siteObject=&quot;CN=Aberdeen,CN=Sites,CN=Configuration,DC=SS64,DC=COM&quot;} -Path &quot;CN=Subnets,CN=Sites
,CN=Configuration,DC=SS64,DC=COM&quot;</span></p>
<p>Create a new subnet object, using an existing subnet object as a template:</p>
<p><span class="code">PS C:\&gt; $subnetTemplate = get-adobject -Identity &quot;CN=192.168.1.0/26,CN=Subnets,CN=Sites,CN=Configuration,DC=SS64,<br>
DC=com&quot; -properties description,location<br>
<br> 
PS C:\&gt; new-adobject -instance $subnetTemplate -name &quot;192.168.1.0/28&quot; -type subnet -path &quot;CN=Subnets,CN=Sites,CN=Configuration,DC=SS64,DC=COM&quot;</span></p>
<p>Create a new contact object, set the msDS-SourceObjectDN property and protect the object from accidental deletion:</p>
<p class="code">PS C:\&gt; New-ADObject -name SaraDavisContact -type contact -ProtectedFromAccidentalDeletion $true -OtherAttributes @{'msDS-SourceObjectDN'=&quot;CN=SS64Contacts,DC=SS64,DC=COM&quot;}</p>
<p class="quote"><i>“Works of art, in my opinion, are the only objects in the material universe to possess internal order, and that is why, though I don't believe that only art matters, I do believe in Art for Art's sake” ~ E. M. Forster</i></p>
<p><b>Related:</b></p>
<p><a href="get-adobject.html">Get-adObject</a> - Get one or more AD objects<br>
<a href="move-adobject.html">Move-adObject</a> - Move an AD object or container to a different container or domain. <br>
<a href="remove-adobject.html">Remove-adObject</a> - Remove an AD object.<br>
<a href="rename-adobject.html">Rename-adObject</a> - Change the name of an AD object. <br>
<a href="restore-adobject.html">Restore-adObject</a> - Restore an AD object.<br>
<a href="set-adobject.html">Set-adObject</a> - Modify an AD object.</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- PowerShell336 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6318961509"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer"><a href="new-adobject.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id=br class="footer, tagline">&copy; Copyright <a href="http://ss64.com/">SS64.com</a> 1999-2014<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
