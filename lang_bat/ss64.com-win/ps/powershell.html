<!doctype html><html>
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Powershell | PowerShell | SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="http://ss64.com/"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="http://ss64.com/ps">PowerShell</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="http://www.google.com/search" method="get">
<button tabindex="-1" type="submit" id="q-img"></button>
<input type="text" name="q" id="q" size="27" maxlength="255" onblur="if(this.value=='')this.value='Search…';" onclick="if(this.value=='Search…')this.value='';" value="Search…">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>Powershell </h1>
<p>Launch a PowerShell session.</p>
<pre>Syntax
      powershell[.exe] [-PSConsoleFile <i>file</i> | -Version <i>version</i>]
         [-NoLogo] [-NoExit] [-Sta] [-NoProfile] [-NonInteractive]
            [-InputFormat {Text | XML}] [-OutputFormat {Text | XML}]
               [-WindowStyle <i>Style</i>] [EncodedCommand <i>Base64EncodedCommand</i>]
                  [-File <i>FilePath Args</i>] [-ExecutionPolicy <i>ExecutionPolicy</i>]
                     [-Command { - | <i>script-block</i> [-args <i>arg-array</i>]
                                   | <i>string</i> [<i>CommandParameters</i>] } ]

      powershell[.exe] -Help | -? | /?
key
 
   -PSConsole <i>File</i>   Load a PowerShell console file. (created with <a href="export-console.html">export-console</a>)

   -Version          Start the specified version of Windows PowerShell.

   -NoLogo           Hide the copyright banner at startup.

   -NoExit           Do not exit after running startup commands.

   -Sta              Start the shell using a single threaded apartment

   -NoProfile        Do not use the user profile.

   -Noninteractive   Don't present an interactive prompt to the user.

   -InputFormat      Format of data sent to Windows PowerShell. Valid values are
                     "Text" (string) or "XML" (serialized CLIXML format). 

   -OutputFormat     Format the output. Valid values are "Text" (string)
                     or "XML" (serialized CLIXML format).
 

   -Command          Execute commands or a script file of commands 
                     If Command is "-", the command text is read from standard input.

   -WindowStyle      Set the window style to Normal, Minimised, Maximised or Hidden.

   -EncodedCommand   Accepts a base-64 encoded string version of a command, Use this to
                     submit commands to PowerShell that require complex quotation marks
                     or curly braces.

   -File             Execute a script file.

   -ExecutionPolicy  Set the default <a href="set-executionpolicy.html">execution policy</a> for the session.

   -Command          Execute the specified commands (and any parameters) as though they
                     were typed at the PowerShell prompt, and then exit, unless NoExit is specified.
                     The value of Command can be "-", a string. or a script block.

                     If the value of Command is "-", the command is read from standard input.

                     Script blocks must be enclosed in braces ({}).
                     Specify a script block only when running PowerShell.exe from PowerShell.

                     The results of the script are returned to the parent shell as
                     deserialized XML objects, not live objects.

                     If the value of Command is a string, it must be the last parameter
                     in the command , any characters typed after command are interpreted
                     as the command arguments.

                     To write a string that runs a PowerShell command, use the format:

                     "& {<i>command</i>}"

                     where the quotation marks indicate a string and the <a href="call.html">call operator</a> (&)
                     causes the command to be executed.

   -Help, -?, /?     Display Help</pre>
<p><br>
Standard <a href="get-alias.html">Aliases</a> for Powershell_ISE.exe:<span class="code"> ise</span></p>
<p>When launching a .ps1 script you may wish to specify <span class="code">-noprofile</span> to make sure that the script runs in a default PowerShell environment and does not load any profile scripts.</p>
<p>If you are launching PowerShell from a CMD shell and passing a command that includes any special characters (such as '<span class="code">%</span>') then you will have to apply a suitable <a href="http://ss64.com/nt/syntax-esc.html#escape">CMD escape character</a> e.g. <span class="code">%%</span></p>
<h2>Exit Codes</h2>
<p>In PowerShell the exit code is stored in the automatic variable <span class="code">$LASTEXITCODE</span>.</p>
<p>To read exit codes (other than 0 or 1) launch the PowerShell script and return the <span class="code">$LASTEXITCODE</span> in a single line like this:</p>
<p><span class="code"><a href="powershell.html">powershell.exe</a> -noprofile C:\scripts\script.ps1; exit $LASTEXITCODE</span></p>
<p>
<b>Examples</b></p>
<p>Load a console and run a Script: </p>
<p><span class="code">PowerShell.exe -PSConsoleFile "C:\scripting\MyShell.psc1" -Command ". 'MyScript.ps1'"</span></p>
<p>Run a Script as Admin: </p>
<p class="code">powershell -noprofile -command &quot;&amp;{ start-process powershell -ArgumentList '-noprofile -file MyScript.ps1' -verb RunAs}&quot;</p>
<p>Run a command to display the security event log: </p>
<p class="code"> powershell -command {get-eventlog -logname security}</p>
<p>Or the same thing but calling PowerShell from the CMD shell:</p>
<p class="code"> powershell -command &quot;&amp; {get-eventlog -logname security}&quot;</p>
<p>PS.cmd - a simple batch file to launch PowerShell with less typing:<span class="code"><br>
@echo off<br>
Powershell.exe %1</span></p>
<p class="quote">&ldquo;If you want to launch big ships you have to go where the water is deep&rdquo; ~ Anon</p>
<p><b>Related:</b></p>
<p><a href="index.html">List of all PowerShell commands </a><br>
Equivalent bash command: <a href="http://ss64.com/bash/index.html">bash</a> - launch bash shell</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- PowerShell336 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6318961509"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer"><a href="powershell.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id=br class="footer, tagline">&copy; Copyright <a href="http://ss64.com/">SS64.com</a> 1999-2014<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
